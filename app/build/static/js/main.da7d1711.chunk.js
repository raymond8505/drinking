(this.webpackJsonpcotd=this.webpackJsonpcotd||[]).push([[0],{32:function(e,t,a){e.exports=a(55)},54:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(25),i=a(4),o=a(5),l=a(7),c=a(6),u=a(59),m=a(61),d=a(58),p=a(17),g=a.n(p),h=a(24),f=a(8),v={game0:{rules:{game0_rule1585428503206:{drinks:"2 drinks",gameKey:"game0",owner:"WCRKE62ab8gw6FB2iCYkOX4XmIg2",rule:"The name of the episode or movie is said or written"},game0_rule1585443393434:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"obvious stock footage"},game0_rule1585443993724:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"ESL Characters speaking English for no reason"},game0_rule1585444223055:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"nut shot"},game0_rule1585445102020:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"obviously empty coffee cup"},game0_rule1585447770911:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"someone rips up a photo "},game0_rule1585507595857:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:'Incorrect portrayal of "hacking"'},game0_rule1585528860565:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"romantic tension between non spouses (will they / wont they characters)"}},title:"General Rules"},game1:{parent_game:"game0",rules:{game1_rule1:{drinks:"1 drink",gameKey:"game1",rule:"Bone snap"},game1_rule1585442777686:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Explosion"},game1_rule1585442794346:{drinks:"2",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"cool explosion (ex: slow mo)"},game1_rule1585442823231:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"unrealistic survival / healing"},game1_rule1585442901374:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"glass breaks"},game1_rule1585442925083:{drinks:"3",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"decapitation"},game1_rule1585443336960:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"slow motion"},game1_rule1585444849287:{drinks:"3",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:'"turn in your badge and gun" / "youre suspended!" / etc'},game1_rule1585448652082:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"headshot"}},title:"Action"},game1585442982618:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game0",rules:{game1585442982618_rule1585442993103:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Any dino related pun"},game1585442982618_rule1585443044303:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Anytime you see a choker or midriff"},game1585442982618_rule1585443065678:{drinks:"drink til it stops",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Dino roar"},game1585442982618_rule1585443084585:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"bad cgi"},game1585442982618_rule1585443110038:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"T Rex does something with his hands"},game1585442982618_rule1585443158546:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Dinosaur is too big to fit in something"},game1585442982618_rule1585443171333:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"poor dino disguising / someone doesnt notice the dino is alive"},game1585442982618_rule1585448716738:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"someone grabs someone else's dick"}},title:"Tammy and the T Rex"},game1585446169128:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1",rules:{game1585446169128_rule1585446187228:{drinks:"1",gameKey:"game1585446169128",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:'"enhance"'}},title:"Police / Crime"},game1585519764301:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1",rules:{game1585519764301_rule1585519780902:{drinks:"1",gameKey:"game1585519764301",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Cross Fade"},game1585519764301_rule1585519789583:{drinks:"1",gameKey:"game1585519764301",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Saxophone Soundtrack"}},title:"Man Hunt"},game1585541082218:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1585541104293",rules:{game1585541082218_rule1585541134205:{drinks:"1",gameKey:"game1585541082218",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Something is bejewelled"},game1585541082218_rule1585541642525:{drinks:"1",gameKey:"game1585541082218",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"a tiger hurts or scares someone"},game1585541082218_rule1585545303143:{drinks:"1",gameKey:"game1585541082218",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"tacky / trashy decorations"}},title:"Tiger King"},game1585541104293:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game0",rules:{game1585541104293_rule1585751022903:{drinks:"1 drink",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Someone Cries"}},title:"Reality TV"},game1585600289161:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1",title:"Jason Statham"},game1585600326133:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1585600289161",rules:{game1585600326133_rule1585600342757:{drinks:"1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Statham uses his boomerang"}},title:"In The Name of the king"},game1585662389801:{owner:"",parent_game:"game1585541104293",title:"90 Day Fiance"},game1585662406239:{owner:"",parent_game:"game1585541104293",rules:{game1585662406239_rule1585662454054:{drinks:"everyone but the closest guess drinks. Price is right rules",gameKey:"game1585662406239",owner:"",rule:"Everyone guesses the budget of each bride before they say it"}},title:"Say Yes To The Dress"},game1585872782855:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game0",title:"test to delete"},game2:{parent_game:"game1",rules:{game2_rule1:{drinks:"1 drink",gameKey:"game2",rule:"Splits"}},title:"Jean Claude Van Damme"},game3:{parent_game:"game0",rules:{game3_rule1:{drinks:"1 sip",gameKey:"game3",owner:"WCRKE62ab8gw6FB2iCYkOX4XmIg2",rule:"Jump Scare"},game3_rule1585427944776:{drinks:"1 drink",gameKey:"game3",owner:"WCRKE62ab8gw6FB2iCYkOX4XmIg2",rule:"rule added by raymond@raymond"}},title:"Horror Movies"},game4:{parent_game:"game0",title:"Cartoons"},game5:{parent_game:"game4",rules:{game5_rule1:{drinks:"drink til it stops",gameKey:"game5",rule:"CGI Webslinging"}},title:"Adventures of Spiderman"}},y=function e(t){var a=this;Object(i.a)(this,e),this.data={},this.hasData=function(){return a.data&&Object.keys(a.data).length>0},this.forEach=function(e,t){if(void 0===t)throw new Error("DataHelper.forEach requires a data parameter");return Object.keys(t).map(e)},this.getGameByKey=function(e){return a.data[e]},this.getChildGames=function(e){var t={};return Object.keys(a.data).map((function(n){var r=a.getGameByKey(n);return r.parent_game&&r.parent_game[0]===e&&(t[n]=r),null})),t},this.gameHasRules=function(e){return e.rules&&Object.keys(e.rules).length>0},this.getGameRules=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=a.getGameByKey(e),s={},i=a;return a.gameHasRules(r)&&a.forEach((function(t){s[t]=Object.assign(r.rules[t],{gameKey:e})}),r.rules),t&&r.parent_game&&r.parent_game.length>0&&r.parent_game.map((function(e){return Object.assign(s,i.getGameRules(e,!1,n))})),s},this.objectCollectionToArrayWithKey=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key",n=[];return a.forEach((function(a){var r=e[a];r[t]=a,n.push(r)}),e),n},this.arrayWithKeyToObjectCollection=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key",a={};return e.forEach((function(e){var n=e[t];e[t]=null,a[n]=e})),a},this.sortRules=function(e,t){var n=a.objectCollectionToArrayWithKey(e);return n.sort((function(e,n){var r="asc"===t.direction?1:-1,s="",i="";switch(t.field){case"rule":case"drinks":s=e[t.field].toLowerCase(),i=n[t.field].toLowerCase();break;case"game":s=a.getGameByKey(e.gameKey).title.toLowerCase(),i=a.getGameByKey(n.gameKey).title.toLowerCase();break;default:s=e[t.field],i=n[t.filed]}return(s=a.sanitizeForSorting(s))<=(i=a.sanitizeForSorting(i))?-1*r:r})),a.arrayWithKeyToObjectCollection(n)},this.sanitizeForSorting=function(e){return['"',"'","-","(",")"].forEach((function(t){var a=new RegExp("^[".concat(t,"]+")),n=new RegExp("[".concat(t,"]+$"));e=e.replace(a,"").replace(n,"")})),e},this.getNewRuleKey=function(e){return"".concat(e,"_rule").concat(Date.now())},this.getNewGameKey=function(){return"game".concat(Date.now())},this.sortGamesBy=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=arguments.length>2?arguments[2]:void 0;if(void 0===n)return{};var r=[],s={},i=0===t.toLowerCase().indexOf("asc")?1:-1;return a.forEach((function(t){var n=a.getGameByKey(t);if(n)try{r.push({key:t,[e]:n[e]})}catch(s){return void console.log(n,s)}}),n),r.sort((function(t,a){switch(typeof t[e]){case"string":default:return t[e]&&a[e]?t[e].toLowerCase()<a[e].toLowerCase()?-1*i:1*i:0}})),r.forEach((function(e){s[e.key]=a.getGameByKey(e.key)})),s},this.getParentGames=function(e){var t="object"===typeof e?e:a.getGameByKey(e);return t.parent_game&&t.parent_game.length>0?t.parent_game.map((function(e){var t=a.getGameByKey(e);return t.gameKey=e,t})):[]},this.gamesToKeys=function(e){return e.map((function(e){return e.gameKey}))},this.getAncestors=function(e){for(var t=[],n=e,r=void 0;void 0!==r;)n=r.key,r=a.getParentGames(n),t.push(r);return t.reverse()},this.gameHasOtherUserGames=function(e,t){var n=a.getChildGames(e),r=!0;return a.forEach((function(e){a.getGameByKey(e).owner===t||(r=!1)}),n),r},this.gameHasOtherUserOwnedRules=function(e,t){var n=!1;return a.forEach((function(a){var r=e.rules[a];r&&Object.keys(r).length>0&&r.owner&&r.owner!==t&&(n=!0)}),e.rules),n},this.data=t},b=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"Loader"},r.a.createElement("div",{className:"lds-dual-ring"}),""!==this.props.message?r.a.createElement("h4",{className:"Loader__message"},this.props.message):null)}}]),a}(r.a.Component);b.defaultProps={message:""};var E=b,k=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"NotFound"},r.a.createElement("h1",null,"Page Not Found"))}}]),a}(r.a.Component),G=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={currentMode:"display"},e.setEditing=function(t){e.setState({editing:t})},e.handleClick=function(t){t.preventDefault(),e.setState({currentMode:"display"===e.state.currentMode?"confirm":"display"}),e.props.handler(t)},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("button",{className:"EditButton EditButton--".concat(this.state.currentMode),onClick:this.handleClick,title:"Edit Game"},r.a.createElement("span",{className:"sr-only"},"display"===this.state.currentMode?"Edit":"Confirm"),r.a.createElement("i",{className:"EditButton__icon",role:"presentation"}))}}]),a}(r.a.Component),S=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={currentMode:"display"},e.handleClick=function(t){t.preventDefault(),e.setState({currentMode:"display"===e.state.currentMode?"confirm":"display"}),e.props.handler(t)},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("button",{className:"DeleteButton DeleteButton--".concat(this.state.currentMode),onClick:this.handleClick,title:"Delete Game"},r.a.createElement("span",{className:"sr-only"},"display"===this.state.currentMode?"Edit":"Confirm"),r.a.createElement("i",{className:"DeleteButton__icon",role:"presentation"}))}}]),a}(r.a.Component),C=a(57),w=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).innerSelect=r.a.createRef(),e.test=function(){return e.innerSelect},e.outPutOptions=function(){var t=[];return e.data=new y(e.props.games),e.data.forEach((function(a){var n=e.data.getGameByKey(a);t.push(r.a.createElement("option",{key:"game-select_"+a,value:a,selected:a===e.props.defaultValue?"selected":""},n.title))}),e.data.sortGamesBy("title","asc",e.props.games)),t},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("select",{className:"GameSelect",ref:this.innerSelect,onChange:this.props.onChange,defaultValue:this.props.defaultValue},this.outPutOptions())}}]),a}(r.a.Component);w.defaultProps={includeToplevel:!1,defaultValue:"game0",onChange:function(e){},excludedGames:[]};var _=w,R=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).ruleField=r.a.createRef(),n.drinksField=r.a.createRef(),n.gameSelect=r.a.createRef(),n.handleRuleEdit=function(e){var t=n.state.editing;if(console.log(n.drinksField,n.ruleField),n.drinksField&&n.ruleField&&n.drinksField.current&&n.ruleField.current){var a=n.drinksField.current.value,r=n.ruleField.current.value;""===a&&(a=n.state.rule.drinks),""===r&&(r=n.state.rule.rule);var s=Object(f.a)({},n.state.rule);s.rule=r,s.drinks=a,s.gameKey=n.gameSelect.current.innerSelect.current.value,n.props.editRule(n.props.rule.gameKey,n.props.ruleIndex,s),n.setState({rule:s})}n.setState({editing:!t})},n.handleRuleDelete=function(e){n.state.editing?n.setState({editing:!1}):window.confirm("Are you sure you want to Delete the rule ".concat(n.state.rule.rule," (").concat(n.state.rule.drinks,")?"))&&(n.props.deleteRule(n.props.rule.gameKey,n.props.ruleIndex),n.setState({editing:!1}))},n.renderRule=function(){var e=r.a.createElement("input",{className:"RuleRow__title-field editable",onKeyUp:function(e){n.closeOnEscape(e),13===e.which&&n.handleRuleEdit()},type:"text",ref:n.ruleField,defaultValue:n.state.rule.rule}),t=r.a.createElement("span",{className:"RuleRow__title-field"},n.state.rule.rule);return n.state.editing?e:t},n.renderOwner=function(e){var t=n.props.getUser(e);return r.a.createElement("span",{className:"RuleRow__owner"},t?t.email:"Unknown User")},n.renderDrinks=function(){var e=r.a.createElement("input",{className:"RuleRow__drinks-field editable",type:"text",disabled:!n.state.editing,ref:n.drinksField,defaultValue:n.props.rule.drinks,onKeyUp:function(e){console.log(e.which),n.closeOnEscape(e),13===e.which&&n.handleRuleEdit()}}),t=r.a.createElement("span",{className:"RuleRow__drinks-field"},n.props.rule.drinks);return n.state.editing?e:t},n.handleDoubleClick=function(e){n.state.editing||n.setState({editing:!0})},n.renderGame=function(e){return n.state.editing?r.a.createElement(_,{games:n.props.games,defaultValue:n.props.rule.gameKey,ref:n.gameSelect}):r.a.createElement(C.a,{to:"/game/".concat(n.props.rule.gameKey),className:"RuleRow__game-link"},e.title)},n.closeOnEscape=function(e){27===e.which&&n.setState({editing:!1})},n.state={editing:!1,rule:null},n}return Object(o.a)(a,[{key:"componentDidUpdate",value:function(){this.ruleField&&this.ruleField.current&&this.ruleField.current.focus()}},{key:"componentWillMount",value:function(){this.setState({rule:this.props.rule}),this.data=new y(this.props.games)}},{key:"render",value:function(){var e=this.data.getGameByKey(this.props.rule.gameKey);return r.a.createElement("tr",{className:"RuleRow",onDoubleClick:this.handleDoubleClick},r.a.createElement("td",{className:"RuleRow__rule-cell"},this.renderRule()),r.a.createElement("td",{className:"RuleRow__drinks-cell"},this.renderDrinks()),r.a.createElement("td",{className:"RuleRow__game-cell"},this.renderGame(e)),r.a.createElement("td",{className:"RuleRow__controls-cell"},this.props.canEditRule(this.props.rule)?r.a.createElement(G,{handler:this.handleRuleEdit}):null,this.props.canDeleteRule(this.props.rule)?r.a.createElement(S,{handler:this.handleRuleDelete}):null))}}]),a}(r.a.Component);R.defaultProps={};var O=R,K=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={rules:void 0,currentFilter:"",order:null},e.filterField=r.a.createRef(),e.ruleMatchesFilter=function(t){return""===e.state.currentFilter||(e.state.currentFilter.toLowerCase().indexOf(t.toLowerCase())>-1||t.toLowerCase().indexOf(e.state.currentFilter.toLowerCase())>-1)},e.renderRuleRows=function(){return r.a.createElement("tbody",null,e.data.forEach((function(t){var a=e.rules[t];if(e.ruleMatchesFilter(a.rule))return r.a.createElement(O,{games:e.props.games,key:t,rule:a,ruleIndex:t,gameIndex:e.props.index,deleteRule:e.deleteRule,editRule:e.props.editRule,canEditRule:e.props.canEditRule,canDeleteRule:e.props.canEditRule,getUser:e.props.getUser})}),e.rules))},e.onFilterKeyUp=function(t){var a=t.currentTarget.value;e.setState({currentFilter:a})},e.deleteRule=function(t,a){var n=Object(f.a)({},e.rules);n[a]&&(delete n[a],e.setState({rules:n}),e.props.deleteRule(t,a))},e.onHeaderCellClick=function(t){var a=t.target;if(a){var n=a.getAttribute("data-field"),r=e.state.order?Object(f.a)({},e.state.order):{field:"",direction:""};r.field===n?r.direction="asc"===r.direction?"desc":"asc":(r.direction="asc",r.field=n),e.setState({order:r})}},e.renderSortLabel=function(t){return e.state.order&&t===e.state.order.field?"asc"===e.state.order.direction?r.a.createElement("span",{className:"RulesList__sort-direction fa fa-chevron-up"}):r.a.createElement("span",{className:"RulesList__sort-direction fa fa-chevron-down"}):null},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keydown",(function(t){e.filterField&&e.filterField.current&&(t.shiftKey&&(t.metaKey||t.ctrlKey)&&70===t.which?e.filterField.current.focus():27===t.which&&(e.filterField.current.value="",e.filterField.current.blur(),e.setState({currentFilter:""})))}))}},{key:"getSnapshotBeforeUpdate",value:function(e,t){return this.currentGameKey=this.props.index,null}},{key:"getSnapshotAfterUpdate",value:function(){this.currentGameKey=this.props.index}},{key:"render",value:function(){var e=this;return this.currentGameKey!==this.props.index&&this.currentGameKey&&setTimeout((function(){e.filterField.current.value="",e.onFilterKeyUp({currentTarget:e.filterField.current})}),1),this.data=new y(this.props.games),this.rules=this.data.getGameRules(this.props.index,!0),this.state.order&&(this.rules=this.data.sortRules(this.rules,this.state.order)),r.a.createElement("div",{className:"RulesList"},r.a.createElement("header",{className:"RulesList__header"},r.a.createElement("input",{ref:this.filterField,type:"search",className:"RulesList__filter-field",placeholder:"Find A Rule",onKeyUp:this.onFilterKeyUp})),r.a.createElement("table",{cellPadding:"0",cellSpacing:"0"},r.a.createElement("thead",{className:"RulesList__header"},r.a.createElement("tr",null,r.a.createElement("th",{className:"RulesList__rule-cell","data-field":"rule",onClick:this.onHeaderCellClick},"Rule",this.renderSortLabel("rule")),r.a.createElement("th",{className:"RulesList__drinks-cell","data-field":"drinks",onClick:this.onHeaderCellClick},"Drinks",this.renderSortLabel("drinks")),r.a.createElement("th",{className:"RulesList__game-cell","data-field":"game",onClick:this.onHeaderCellClick},"Game",this.renderSortLabel("game")),r.a.createElement("th",{className:"RulesList__controls-cell"},"\xa0"))),this.renderRuleRows()))}}]),a}(r.a.Component);K.defaultProps={recursive:!1};var j=K,F=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).gameSelect=r.a.createRef(),e.ruleField=r.a.createRef(),e.drinksField=r.a.createRef(),e.onWindowKeyPress=function(t){174===t.which&&t.altKey&&(e.ruleField.current.focus(),t.preventDefault())},e.resetForm=function(){e.gameSelect.current.test().current.value=e.props.gameIndex,e.ruleField.current.focus()},e.clearForm=function(){e.ruleField.current.value=e.drinksField.current.value=""},e.handleAddClick=function(t){var a=e.gameSelect.current.innerSelect.current.value,n=e.ruleField.current.value,r=e.drinksField.current.value;if(""!==n&&""!==r&&a&&""!==a){var s={rule:n,drinks:r};e.props.addRule(a,s),e.clearForm(),e.resetForm()}else alert("Please choose a game, enter a rule and a drink penalty.")},e.onKeyUp=function(t){13===t.which&&(e.handleAddClick(),t.preventDefault())},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.data=new y(this.props.games),window.addEventListener("keypress",this.onWindowKeyPress)}},{key:"render",value:function(){this.data=new y(this.props.games);this.data.getGameByKey(this.props.gameIndex);var e=this.data.sortGamesBy("title","asc",this.props.games);return r.a.createElement("div",{className:"AddRulesForm"},r.a.createElement(_,{games:e,name:"game",defaultValue:this.props.gameIndex,ref:this.gameSelect,className:"AddRulesForm__game-select"}),r.a.createElement("textarea",{placeholder:"Rule",name:"rule",ref:this.ruleField,className:"AddRulesForm__rule-field"}),r.a.createElement("input",{type:"text",name:"drinks",ref:this.drinksField,onKeyUp:this.onKeyUp,placeholder:"Drinks",className:"AddRulesForm__drinks-field"}),r.a.createElement("button",{type:"button",onClick:this.handleAddClick},"Add Rule"))}}]),a}(r.a.Component);F.defaultProps={};var x=F,D=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e="".concat(this.props.tag);return r.a.createElement(e,{className:"Alert Alert--".concat(this.props.type)},this.props.children)}}]),a}(r.a.Component);D.defaultProps={tag:"span",type:"info"};var N=D,T=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).titleField=r.a.createRef(),n.onAddEditClick=function(e){var t=!n.state.editing;t||(n.props.game.title=n.titleField.current.value,n.props.editGame(n.props.index,n.props.game)),n.setState({editing:t})},n.onDeleteClick=function(e){window.confirm('Are you sure you want to delete "'.concat(n.game.title,'"'))&&n.props.deleteGame(n.props.index)},n.onNameInputKeyPress=function(e){switch(e.which){case 13:n.onAddEditClick();break;case 27:n.setState({editing:!1})}},n.renderName=function(){var e=r.a.createElement("input",{onClick:n.viewGame,name:"GameListItem__title",ref:n.titleField,className:"GameListItem__title editable",onKeyUp:n.onNameInputKeyPress,defaultValue:n.game.title}),t=r.a.createElement(C.a,{to:"/game/".concat(n.props.index),className:"GameListItem__title"},n.game.title);return n.state.editing?e:t},n.handleDoubleClick=function(e){n.state.editing||n.setState({editing:!0})},n.onCopyClick=function(e){n.props.copyGame(n.props.index)},n.state={editing:!1,game:{}},n}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.setState({game:this.props.game})}},{key:"componentDidUpdate",value:function(){this.titleField&&this.titleField.current&&this.titleField.current.focus()}},{key:"render",value:function(){return this.data=new y(this.props.games),this.game=this.data.getGameByKey(this.props.index),r.a.createElement("li",{className:"GameListItem ".concat(this.props.highlight?" GameListItem--highlight":""),id:this.props.index,onDoubleClick:this.handleDoubleClick},r.a.createElement("header",{className:"GameListItem__header"},this.renderName(),r.a.createElement("span",{className:"GameListItem__controls-shell"},this.props.canEditGame(this.game)?r.a.createElement(G,{handler:this.onAddEditClick}):null,this.props.canDeleteGame(this.props.index)?r.a.createElement(S,{handler:this.onDeleteClick}):null,this.props.userLoggedIn()?r.a.createElement("button",{type:"button",className:"GameListItem__copy-btn",onClick:this.onCopyClick,title:"Copy Game"},r.a.createElement("span",{className:"sr-only"},"duplicate this game"),r.a.createElement("i",{className:"fa fa-copy"})):null)),this.props.showChildren?r.a.createElement(L,{game:this.game,games:this.props.games,parent:this.props.index,canEditGame:this.props.canEditGame,canEditRule:this.props.canEditRule,canDeleteGame:this.props.canDeleteGame,canDeleteRule:this.props.canEditRule,copyGame:this.props.copyGame}):null)}}]),a}(r.a.Component);T.defaultProps={showChildren:!1,highlight:!1};var V=T,A=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).renderGameList=function(){if(e.data&&e.data.hasData()){e.data=new y(e.props.games);var t=void 0!==e.props.parent?e.data.getChildGames(e.props.parent):e.data.sortGamesBy("title","asc",e.props.games);return t=e.data.sortGamesBy("title","asc",t),e.data.forEach((function(a){return r.a.createElement(V,{deleteGame:e.props.deleteGame,editGame:e.props.editGame,copyGame:e.props.copyGame,key:a,index:a,games:t,game:e.data.getGameByKey(a),highlight:e.props.currentIndex===a,canEditGame:e.props.canEditGame,canEditRule:e.props.canEditRule,canDeleteGame:e.props.canDeleteGame,userLoggedIn:e.props.userLoggedIn,canDeleteRule:e.props.canEditRule})}),t)}return r.a.createElement(N,{type:"error",tag:"li"},"No Games")},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.data=new y(this.props.games)}},{key:"render",value:function(){return this.data=new y(this.props.games),r.a.createElement("ul",{className:"GameList"},this.renderGameList())}}]),a}(r.a.Component);A.defaultProps={parent:void 0,currentIndex:void 0};var L=A,I="uGqTXpxQHzg4K7DRhObVWvValvF3",W=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).titleField=r.a.createRef(),n.data=new y(n.props.games),n.onTitleFieldKeyPress=function(e){if(n.state&&n.state.suggestions&&!n.allSuggestionsSelected())switch(e.which){case 40:n.nextSuggestion();break;case 38:n.previousSuggestion();break;case 27:n.clearSuggestions();break;case 13:var t=n.state.suggestions[n.state.currentSuggestion];t&&t.gameKey&&n.chooseGame(t),e.preventDefault();break;default:console.log(e.which)}n.renderAutoComplete(e.target.value)},n.isSelected=function(e){var t=!1;for(var a in n.props.selectedGames)if(n.props.selectedGames[a].gameKey===e.gameKey){t=!0;break}return t},n.clearSuggestions=function(){n.titleField.current.value="",n.renderAutoComplete(""),n.setState({currentSuggestion:0})},n.renderAutoComplete=function(e){var t=[];""!==(e=e.toLowerCase())&&n.data.forEach((function(a){var r=n.props.games[a];r.title.toLowerCase().indexOf(e)>-1&&("game0"===r.gameKey&&n.props.includeGeneralRules,!n.props.excludedGames.includes(r.gameKey)&&(r.gameKey=a,t.push(r)))}),n.props.games),n.setState({suggestions:t})},n.chooseGame=function(e){n.titleField.current.value=e.title,n.props.onGameSelect(e),n.clearTitleField(),n.titleField.current.focus()},n.clearTitleField=function(){n.titleField.current.value="",n.setState({suggestions:[]})},n.setCurrentSuggestion=function(e){n.setState({currentSuggestion:e})},n.previousSuggestion=function(){var e=n.findPreviousSuggestion(n.state.currentSuggestion||n.state.suggestions.length||0);n.setCurrentSuggestion(e)},n.findPreviousSuggestion=function(e){var t=0===e?n.state.suggestions.length-1:e-1;return console.log(e,t),n.isSelected(n.state.suggestions[t])?n.findPreviousSuggestion(t):t},n.nextSuggestion=function(){var e=n.findNextSuggestion(n.state.currentSuggestion||0);n.setCurrentSuggestion(e)},n.findNextSuggestion=function(e){var t=e===n.state.suggestions.length-1?0:e+1;return n.isSelected(n.state.suggestions[t])?n.findNextSuggestion(t):t},n.allSuggestionsSelected=function(){var e=n.state.suggestions.length>0;for(var t in n.state.suggestions){var a=n.state.suggestions[t];if(!n.isSelected(a)){e=!1;break}}return e},n.renderSuggestions=function(){if(n.state&&n.state.suggestions&&n.state.suggestions.length>0)return r.a.createElement("ul",{className:"GameAutoComplete__suggestions",style:{height:"".concat(1.55*n.state.suggestions.length,"em")}},n.state.suggestions.map((function(e,t){var a=["GameAutoComplete__suggestion"];return n.isSelected(e)&&a.push("GameAutoComplete__suggestion--selected"),(t===n.state.currentSuggestion||!n.state.currentSuggestion&&0===t)&&a.push("GameAutoComplete__suggestion--current"),r.a.createElement("li",{className:a.join(" "),key:"gac_".concat(e.gameKey),onClick:function(t){n.chooseGame(e)},onMouseEnter:function(a){n.isSelected(e)||n.setCurrentSuggestion(t,e)}},e.title)})))},n.state={suggestions:[],selectedGames:[],currentSelection:0,currentSuggestion:0},n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"GameAutoComplete"},r.a.createElement("input",{type:"text",ref:this.titleField,placeholder:this.props.placeholder,onKeyUp:this.onTitleFieldKeyPress}),this.renderSuggestions())}}]),a}(r.a.Component);W.defaultProps={placeholder:"Game Title",excludedGames:[],includeGeneralRules:!1};var H=W,B=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onClose=function(t){e.props.onClose(t,e.props.game)},e}return Object(o.a)(a,[{key:"render",value:function(){var e="".concat(this.props.tag);return r.a.createElement(e,{className:"GamePill GamePill--".concat(this.props.game.gameKey)},this.props.linkGame?r.a.createElement(C.a,{to:"/game/".concat(this.props.game.gameKey)},this.props.game.title):this.props.game.title,this.props.showCloseBtn?r.a.createElement("button",{className:"GamePill__close-btn",onClick:this.onClose},"\xd7"):null)}}]),a}(r.a.Component);B.defaultProps={tag:"li",showCloseBtn:!0,linkGame:!1};var M=B,P=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={selectedGames:e.props.selectedGames,includeToplevel:!0},e.sanitizeGames=function(t){if(!e.gameSelected("game0")){var a=new y(e.props.games).getGameByKey("game0");a.gameKey="game0",t.push(a)}return t},e.clearGames=function(){e.setState({selectedGames:[]})},e.newGameSelect=function(t){if(!e.gameSelected(t)){var a=e.state.selectedGames;a.push(t),e.setState({selectedGames:a})}},e.gameSelected=function(t){var a=!1,n="object"===typeof t?t.gameKey:t;return e.state.selectedGames.forEach((function(e,t){n!==e.gameKey||(a=!0)})),a},e.onGameRemoved=function(t,a){var n=e.state.selectedGames;n=n.filter((function(e){return a.gameKey!==e.gameKey})),e.setState({selectedGames:n})},e.renderGames=function(){return e.state.selectedGames.map((function(t){return r.a.createElement(M,{key:"gms_".concat(t.gameKey),game:t,onClose:e.onGameRemoved})}))},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("ul",{className:"GameMultiSelect"},this.renderGames(),r.a.createElement("li",{className:"GameMultiSelect__add-game"},r.a.createElement(H,{games:this.props.games,selectedGames:this.state.selectedGames,onGameSelect:this.newGameSelect,placeholder:this.props.placeholder,excludedGames:this.props.excludedGames})))}}]),a}(r.a.Component);P.defaultProps={selectedGames:[],excludedGames:[]};var U=P,q=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).titleField=r.a.createRef(),e.gameSelect=r.a.createRef(),e.resetForm=function(){e.clearForm(),e.titleField.current.focus()},e.clearForm=function(){e.titleField.current.value="",e.gameSelect.current.clearGames()},e.onKeyUp=function(t){e.props.listenForShortcuts&&13===t.which&&(e.onAddGameClick(),t.preventDefault())},e.onAddGameClick=function(t){var a=e.titleField.current.value,n=e.gameSelect.current.state.selectedGames;e.props.addGame(a,n),e.resetForm()},e.onMultiSelectError=function(e){console.log(e)},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"AddGameForm"},r.a.createElement(U,{games:this.props.games,includeToplevel:!0,defaultValue:this.props.parent,ref:this.gameSelect,placeholder:"Add a Parent Game",onError:this.onMultiSelectError}),r.a.createElement("input",{type:"text",placeholder:"Game Title",ref:this.titleField,onKeyUp:this.onKeyUp}),r.a.createElement("button",{type:"text",onClick:this.onAddGameClick},"Add Game"))}}]),a}(r.a.Component);q.defaultProps={parent:["game0"],listenForShortcuts:!1};var z=q,X=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={animating:!1,open:!0},e.maxCombo=10,e.animateSpeed=180,e.onGlobalKeyPress=function(t){var a=t.target.tagName.toLowerCase();if("input"!==a&&"textarea"!==a&&"select"!==a)switch(t.which){case 107:e.addDrink();break;case 109:e.removeDrink();break;case 106:e.clearDrinks()}},e.addDrink=function(){if(e.props.count<e.maxCombo){var t=e.props.count+1;e.props.setSessionCombo(t)}},e.removeDrink=function(){e.props.count>0&&e.props.setSessionCombo(e.props.count-1)},e.clearDrinks=function(){e.props.setSessionCombo(0)},e.handleRemoveDrinkClick=function(t){e.props.count>0&&(e.removeDrink(),e.animateCount())},e.handleClearDrinksClick=function(t){e.clearDrinks()},e.animateCount=function(){e.setState({animating:!0}),setTimeout((function(){e.setState({animating:!1})}),e.animateSpeed)},e.handleAddDrinkClick=function(t){e.props.count<e.maxCombo&&(e.addDrink(),e.animateCount())},e.calcShotHeight=function(){return 0===e.props.count?0:e.props.count/e.maxCombo*100+"%"},e.handleToggleClick=function(t){e.setState({open:!e.state.open})},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){window.addEventListener("keyup",this.onGlobalKeyPress)}},{key:"render",value:function(){return r.a.createElement("aside",{className:"ComboCounter".concat(this.state.animating?" ComboCounter--animating":" ComboCounter--animated").concat(this.props.count===this.maxCombo?" ComboCounter--full":"").concat(0===this.props.count?" ComboCounter--empty":"").concat(this.state.open?" ComboCounter--open":" ComboCounter--closed")},r.a.createElement("button",{className:"ComboCounter__toggle-btn ComboCounter__toggle-btn--open",onClick:this.handleToggleClick},r.a.createElement("i",{className:"fa fa-chevron-left"})),r.a.createElement("div",{className:"ComboCounter__count"},this.props.count),r.a.createElement("div",{className:"ComboCounter__glass-wrap"},r.a.createElement("div",{className:"ComboCounter__shot-glass"},r.a.createElement("div",{className:"ComboCounter__shot-volume",style:{height:this.calcShotHeight()}})),r.a.createElement("div",{className:"ComboCounter__button-shell"},r.a.createElement("button",{className:"ComboCounter__remove-drink-btn",onClick:this.handleRemoveDrinkClick},"-"),r.a.createElement("button",{className:"ComboCounter__clear-drinks-btn",onClick:this.handleClearDrinksClick},"\xd7"))),r.a.createElement("button",{className:"ComboCounter__add-drink-btn",onClick:this.handleAddDrinkClick},"+"),r.a.createElement("button",{className:"ComboCounter__toggle-btn ComboCounter__toggle-btn--close",onClick:this.handleToggleClick},r.a.createElement("i",{className:"fa fa-chevron-right"})))}}]),a}(r.a.Component);X.defaultTypes={count:0};var Q=X,J=a(26),Y=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={game:void 0,editing:!1},e.titleInput=r.a.createRef(),e.editButton=r.a.createRef(),e.shell=r.a.createRef(),e.parentsMS=r.a.createRef(),e.gameScrollPostBeforeUpdate=0,e.onParentChange=function(t){var a=t.currentTarget.value,n=e.props.index,r=Object(f.a)({},e.data.getGameByKey(n));r.parent_game=a,console.log(r),e.props.editGame(n,r)},e.handleTitleEditClick=function(t){if(e.state.editing){var a=e.data.getGameByKey(e.props.index);""===e.titleInput.current.value?e.titleInput.current.value=a.title:(e.data=new y(e.props.games),a.title=e.titleInput.current.value,a.parent_game=e.data.gamesToKeys(e.parentsMS.current.state.selectedGames),e.props.editGame(e.props.index,a))}else e.titleInput.current.focus();e.setState({editing:!e.state.editing})},e.onDeleteClick=function(t){e.data=new y(e.props.games);var a=e.data.getGameByKey(e.props.index);e.state.editing?e.setState({editing:!1}):window.confirm('Are you sure you want to delete "'.concat(a.title,'"?'))&&e.props.deleteGame(e.props.index)},e.renderParentPills=function(){var t=e.data.getGameByKey(e.props.index),a=e.data.getParentGames(t);return e.state.editing?r.a.createElement("div",{className:"Game__parents"},r.a.createElement(U,{ref:e.parentsMS,selectedGames:a,excludedGames:[e.props.index],games:e.props.games})):a&&a.length>0?r.a.createElement("ul",{className:"Game__parents"},a.map((function(e){return r.a.createElement(M,{linkGame:!0,key:"pill_".concat(e.gameKey),game:e,showCloseBtn:!1})}))):null},e.renderBreadCrumbs=function(){var t=e.data.getAncestors(e.props.index),a=[];return t.forEach((function(e,n){a.push(r.a.createElement(C.a,{to:"/game/".concat(e.key)},e.game.title)),n<t.length-1&&a.push(r.a.createElement("span",{class:"Game__parent-delimiter"},">"))})),a},e}return Object(o.a)(a,[{key:"getSnapshotBeforeUpdate",value:function(e,t){return this.gameScrollPostBeforeUpdate=this.shell.current?this.shell.current.scrollTop:0,this.currentGameKey=this.props.index,null}},{key:"componentDidUpdate",value:function(e){var t=this;setTimeout((function(){t.shell.current&&t.shell.current.scrollTo(0,t.gameScrollPostBeforeUpdate)}),1),this.state.editing&&this.titleInput.current.focus(),this.shell.current&&this.shell.current.scrollTo(0,0)}},{key:"render",value:function(){var e=this;this.data=new y(this.props.games);var t=this.data.getGameByKey(this.props.index);return t?r.a.createElement("div",{className:"Game ".concat(this.state.editing?" Game--editing":""),ref:this.shell},r.a.createElement(J.a,null,r.a.createElement("title",null,t.title+" | Drinking Games")),r.a.createElement(Q,{setSessionCombo:this.props.setSessionCombo,count:this.props.currentComboCount}),this.renderParentPills(),r.a.createElement("h1",{className:"Game__title",onDoubleClick:function(t){e.handleTitleEditClick()}},r.a.createElement("input",{name:this.props.index+Date.now(),key:this.props.index+Date.now(),type:"text",style:{width:"".concat(t.title.length,"ch")},defaultValue:t.title,ref:this.titleInput,disabled:!this.state.editing,className:"Game__title-value editable",onKeyUp:function(t){switch(t.which){case 13:e.handleTitleEditClick();break;case 27:e.setState({editing:!1})}}}),this.props.canEditGame(this.props.index)?r.a.createElement("div",{className:"Game__parent-change-select"},r.a.createElement(G,{handler:this.handleTitleEditClick,ref:this.editButton}),this.props.canDeleteGame(this.props.index)?r.a.createElement(S,{handler:this.onDeleteClick}):null):null),r.a.createElement("section",{className:"Game__rules"},r.a.createElement("h2",null,"Rules"),r.a.createElement(j,{games:this.props.games,index:this.props.index,recursive:!0,deleteRule:this.props.deleteRule,editRule:this.props.editRule,canEditRule:this.props.canEditRule,canDeleteRule:this.props.canEditRule,getUser:this.props.getUser})),this.props.userLoggedIn()?r.a.createElement("section",{className:"Game__add-rules"},r.a.createElement("h3",null,"Add Rule"),r.a.createElement(x,{games:this.props.games,gameIndex:this.props.index,addRule:this.props.addRule})):null,r.a.createElement("section",{className:"Game__child-games"},r.a.createElement("h2",null,"Sub Games"),r.a.createElement(L,{parent:this.props.index,editGame:this.props.editGame,games:this.props.games,deleteGame:this.props.deleteGame,copyGame:this.props.copyGame,canEditGame:this.props.canEditGame,canEditRule:this.props.canEditRule,canDeleteGame:this.props.canDeleteGame,canDeleteRule:this.props.canEditRule,userLoggedIn:this.props.userLoggedIn}),r.a.createElement("h3",null,"Add A Sub Game"),this.props.userLoggedIn()?r.a.createElement(z,{games:this.props.games,parent:[this.props.index],addGame:this.props.addGame}):null)):k}}]),a}(r.a.Component),$=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).data=null,n.onToggleClick=function(e){n.setState({visible:!n.state.visible})},n.state={visible:!0},setTimeout((function(){n.setState({visible:!1})}),1500),n}return Object(o.a)(a,[{key:"render",value:function(){this.data=new y(this.props.games);var e=this.props.games;return r.a.createElement("div",{className:"Games ".concat(this.state.visible?"Games--visible":"")},r.a.createElement("button",{type:"button",className:"Games__toggle-btn",onClick:this.onToggleClick},this.state.visible?r.a.createElement("i",{className:"fa fa-chevron-left"}):r.a.createElement("i",{class:"fa fa-bars"})),r.a.createElement("h1",null,"Drinking Games"),r.a.createElement(L,{games:e,deleteGame:this.props.deleteGame,editGame:this.props.editGame,canEditGame:this.props.canEditGame,canEditRules:this.props.canEditRules,canDeleteGame:this.props.canDeleteGame,canDeleteRules:this.props.canEditRules,copyGame:this.props.copyGame,currentIndex:this.props.currentIndex,userLoggedIn:this.props.userLoggedIn}),this.props.userLoggedIn()?r.a.createElement("section",{className:"Games__add-a-game"},r.a.createElement("h2",null,"Add a Game"),r.a.createElement(z,{games:this.props.games,listenForShortcuts:!0,addGame:this.props.addGame})):null)}}]),a}(r.a.Component);$.defaultProps={parent:"game0",currentIndex:void 0};var Z=$,ee=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={currentSession:e.props.currentSession},e.keyField=r.a.createRef(),e.handleCreateSession=function(t){e.props.createSession()},e.leaveSession=function(){e.setState({currentSession:void 0}),e.props.leaveSession()},e.handleJoinSession=function(t){var a=e.keyField.current.value;e.props.joinSession(a)},e.renderSessionButtons=function(){return void 0===e.props.currentSession?r.a.createElement("div",{className:"SessionManager__buttons"},r.a.createElement("button",{className:"SessionManager__create-session",onClick:e.handleCreateSession},"Create Session"),r.a.createElement("input",{type:"text",className:"SessionManager__key-field",ref:e.keyField,placeholder:"Session Code"}),r.a.createElement("button",{className:"SessionManager__join-session",onClick:e.handleJoinSession},"Join Session")):r.a.createElement("div",{className:"SessionManager__current-session"},r.a.createElement("a",{title:"Copy this link address and send to people you want to join the session",href:"/join/".concat(e.props.currentSession),className:"SeassionManager__session-key"},e.props.currentSession),r.a.createElement("button",{className:"SessionManager__leave-session-btn",onClick:e.leaveSession},"Leave Session"))},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"SessionManager"},this.renderSessionButtons())}}]),a}(r.a.Component),te=a(60),ae=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={open:!1},e.shortcuts=[{combo:"+ (plus)",desc:"Adds a drink to the Combo Counter"},{combo:"- (minus)",desc:"Removes a drink from the Combo Counter"},{combo:"* (asterisk)",desc:"Resets the Combo Count to 0"},{combo:"cmd / ctrl + shift + F",desc:"Focuses the rule filter field in a Game to filter the rules"},{combo:"option / alt + R",desc:"Focus Add a Rule form"}],e.show=function(){e.setState({open:!0})},e.close=function(){e.setState({open:!1})},e.renderShortcuts=function(){return e.shortcuts.map((function(e,t){return r.a.createElement("li",{key:"shortcut_".concat(t),className:"ShortcutsModal__shortcut"},r.a.createElement("div",{className:"ShortcutsModal__shortcut-keys"},e.combo),r.a.createElement("div",{className:"ShortcutsModal__shortcut-description"},e.desc))}))},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){var e=this;window.addEventListener("keyup",(function(t){27===t.which&&e.close()}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"ShortcutsModal".concat(this.state.open?" ShortcutsModal--open":"")},r.a.createElement("div",{className:"ShortcutsModal__dialog"},r.a.createElement("header",{className:"ShortcutsModal__dialog-header"},r.a.createElement("h2",{className:"ShortcutsModal__title"},"Keyboard Shortcuts"),r.a.createElement("button",{className:"ShortcutsModal__close-btn",onClick:this.close},"\xd7")),r.a.createElement("div",{className:"ShortcutsModal__body"},r.a.createElement("ul",{className:"ShortcutsModal__shortcuts"},this.renderShortcuts()))))}}]),a}(r.a.Component),ne=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).shortcuts=r.a.createRef(),e.showShortcuts=function(){e.shortcuts.current.show()},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("main",{className:"Desktop"},r.a.createElement(Z,{games:this.props.games,editGame:this.props.editGame,addGame:this.props.addGame,deleteGame:this.props.deleteGame,canEditGame:this.props.canEditGame,canEditRule:this.props.canEditRule,canDeleteGame:this.props.canDeleteGame,canDeleteRule:this.props.canEditRule,copyGame:this.props.copyGame,userLoggedIn:this.props.userLoggedIn,getUser:this.props.getUser,currentIndex:this.props.match.params.ID}),"game"===this.props.mode?r.a.createElement("div",{className:"GameShell"},r.a.createElement("header",{className:"App__header"},r.a.createElement("span",null,r.a.createElement(C.a,{to:"/",className:"App__home-link"},"Home"),this.props.renderAuthButton()),r.a.createElement(ee,{createSession:this.props.createSession,leaveSession:this.props.leaveSession,joinSession:this.props.joinSession,currentSession:this.props.currentSession}),r.a.createElement("span",{className:"App__current-user"},this.props.user.email),r.a.createElement("button",{className:"App__shortcuts-ref",onClick:this.showShortcuts},r.a.createElement("i",{className:"fa fa-keyboard-o"}))),r.a.createElement(Y,{index:this.props.match.params.ID,games:this.props.games,editRule:this.props.editRule,deleteRule:this.props.deleteRule,deleteGame:this.props.deleteGame,addRule:this.props.addRule,editGame:this.props.editGame,addGame:this.props.addGame,canEditGame:this.props.canEditGame,canEditRule:this.props.canEditRule,canDeleteGame:this.props.canDeleteGame,canDeleteRule:this.props.canEditRule,copyGame:this.props.copyGame,userLoggedIn:this.props.userLoggedIn,getUser:this.props.getUser,setSessionCombo:this.props.setSessionCombo,currentComboCount:this.props.currentComboCount})):r.a.createElement("div",{className:"Desktop__alert-shell"},r.a.createElement(N,{tag:"div",type:"info"},"Choose a game from the left hand menu")),r.a.createElement(ae,{ref:this.shortcuts}))}}]),a}(r.a.Component);ne.defaultProps={currentIndex:void 0};var re=Object(te.a)(ne),se=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).userField=r.a.createRef(),e.passwordField=r.a.createRef(),e.authenticate=function(t){console.log("loader auth");var a=e.userField.current.value,n=e.passwordField.current.value;e.props.authenticate(a,n)},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"Login"},r.a.createElement("form",{className:"Login__form"},r.a.createElement("h2",null,"Login"),r.a.createElement("p",null,"Sign in to start drinking"),this.props.error?r.a.createElement(N,{type:"error"},this.props.error):null,r.a.createElement("input",{type:"text",required:!0,ref:this.userField,placeholder:"Email"}),r.a.createElement("input",{type:"password",required:!0,ref:this.passwordField,placeholder:"Password"}),r.a.createElement("button",{type:"button",className:"Login__login",onClick:this.authenticate},"Turn Down For What"),r.a.createElement(C.a,{className:"Login__signup ",to:"/signup"},"Get Started Turnin' Up")))}}]),a}(r.a.Component),ie=a(16),oe=a.n(ie),le=a(31),ce=a.n(le),ue={firebase:{apiKey:"AIzaSyBqPifaPtgVVbc222q6U09NBRuHTn9ECr0",authDomain:"raymond-catch-of-the-day.firebaseapp.com",databaseURL:"https://raymond-catch-of-the-day.firebaseio.com",projectId:"raymond-catch-of-the-day",storageBucket:"raymond-catch-of-the-day.appspot.com",messagingSenderId:"425132188904",appId:"1:425132188904:web:04405d03ba6769cc5f555d",measurementId:"G-SJZ98PJSWE"}},me=oe.a.initializeApp(ue.firebase),de=ce.a.createClass(me.database()),pe=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).userField=r.a.createRef(),e.passwordField=r.a.createRef(),e.passwordField2=r.a.createRef(),e.state={error:null},e.signup=function(t){var a=e.userField.current.value,n=e.passwordField.current.value;n!==e.passwordField2.current.value?e.setState({error:"Passwords don't match"}):e.props.signup(a,n)},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.setState({error:this.props.error})}},{key:"render",value:function(){var e=this.props.error||this.state.error;return r.a.createElement("div",{className:"Signup"},r.a.createElement("form",{className:"Signup__form"},r.a.createElement("h2",null,"Signup"),r.a.createElement("p",null,"Sign in to start drinking"),e?r.a.createElement(N,{type:"error"},e):null,r.a.createElement("input",{type:"text",required:!0,ref:this.userField,placeholder:"Email"}),r.a.createElement("input",{type:"password",required:!0,ref:this.passwordField,placeholder:"Password"}),r.a.createElement("input",{type:"password",required:!0,ref:this.passwordField2,placeholder:"Confirm Password"}),r.a.createElement("button",{type:"button",className:"Signup__Signup",onClick:this.signup},"Turn Down For What")))}}]),a}(r.a.Component);pe.defaultProps={error:null};var ge=pe,he=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={games:{},mobile:!1,user:{uid:""},users:{},loading:!0,signupError:null,loginError:null,loggingIn:!1,currentSession:void 0,sessions:{},gamesInited:!1},e.sessionKeyLength=4,e.sessionLife=864e5,e.shortCutsModal=r.a.createRef(),e.editGame=function(t,a){var n=Object(f.a)({},e.state.games);n[t]=a,e.setState({games:n})},e.getCurrentSessionComboCount=function(){return e.inASession()?e.state.sessions[e.state.currentSession].currentComboCount:0},e.setSession=function(t){var a={created:(new Date).getTime(),currentComboCount:0},n=Object(f.a)({},e.state.sessions);(n=e.pruneSessions(n))[t]=a,e.setState({sessions:n}),setTimeout((function(){e.joinSession(t)}),10)},e.inASession=function(){return void 0!==e.state.currentSession},e.setSessionCombo=function(t){if(e.inASession()){var a=Object(f.a)({},e.state.sessions);a[e.state.currentSession].currentComboCount=t,e.setState({sessions:a})}else alert("The Combo Counter can only be used in a session")},e.pruneSessions=function(t){var a=(new Date).getTime();return e.data.forEach((function(n){var r=t[n];a-r.created>=e.sessionLife&&(t[n]=null)}),t),t},e.joinSession=function(t){return t=t.toUpperCase(),e.sessionKeyExists(t)?(e.setState({currentSession:t}),window.sessionStorage.setItem("currentSession",t),!0):(alert('No session with the code "'.concat(t,'" currently exists.')),!1)},e.leaveSession=function(){e.setState({currentSession:void 0}),window.sessionStorage.removeItem("currentSession")},e.sessionKeyExists=function(t){return void 0!==e.state.sessions[t]},e.generateSessionKey=function(){for(var t,a="",n=0;n<e.sessionKeyLength;n++)t=Math.round(25*Math.random())+65,a+=String.fromCharCode(t);return a.toUpperCase()},e.generateUniqueSessionKey=function(){var t=e.generateSessionKey();do{t=e.generateSessionKey()}while(void 0!==e.state.sessions[t]);return t},e.createSession=function(){var t=e.generateUniqueSessionKey();return e.setSession(t),t},e.canEditRule=function(t){return e.userLoggedIn()},e.canEditGame=function(t){var a="string"===typeof t?e.data.getGameByKey(t):t;return e.state.user.uid===I||a.owner&&a.owner===e.state.user.uid},e.canDeleteRule=function(t){return e.state.user.uid===I||t.owner===e.state.user.uid},e.canDeleteGame=function(t){var a=e.data.getGameByKey(t);return e.state.user.uid===I||!(!a.owner||a.owner!==e.state.user.uid)&&e.data.gameHasOtherUserGames(t,e.state.user.uid)},e.editRule=function(t,a,n){console.log(t,a,n);var r=Object(f.a)({},e.state.games),s=r[t];if(n.drinks=e.sanitizeDrinks(n.drinks),s&&s.rules&&s.rules[a]&&t===n.gameKey)r[t].rules[a]=n;else{console.log("dif gam game");var i=s,o=r[n.gameKey];i&&o&&(o.rules||(o.rules={}),r[t].rules[a]=null,r[n.gameKey].rules[a]=n)}e.setState({games:r})},e.deleteRule=function(t,a){var n=Object(f.a)({},e.state.games);n&&n[t]&&n[t].rules[a]&&(n[t].rules[a]=null,e.setState({games:n}))},e.addRule=function(t,a){a.owner=e.state.user.uid;var n=e.data.getNewRuleKey(t),r=Object(f.a)({},e.state.games);r[t].rules||(r[t].rules={}),r[t].rules[n]=a,e.setState({games:r})},e.addGame=function(t,a){var n={title:t,rules:{}},r=a.map((function(e){return e.gameKey}));r.includes("game0")||r.push("game0"),console.log(r),n.owner=e.state.user.uid,""!==r&&(n.parent_game=r);var s=Object(f.a)({},e.state.games),i=e.data.getNewGameKey();s[i]=n,e.setState({games:s}),e.viewGame(i)},e.copyRules=function(t,a,n){t=Object(f.a)({},t);var r={};return e.data.forEach((function(s){var i=s.replace(a,n);r[i]=Object(f.a)({},t[s]),r[i].gameKey=n,r[i].owner=e.state.user.uid}),t),r},e.copyGame=function(t){e.data=new y(e.state.games);var a=Object(f.a)({},e.state.games),n=Object(f.a)({},e.data.getGameByKey(t)),r=e.data.getNewGameKey();n.title+=" Copy",n.owner=e.state.user.uid,a[r]=n,a[r].rules=e.copyRules(n.rules,t,r),e.setState({games:a}),e.viewGame(r)},e.deleteGame=function(t){var a=Object(f.a)({},e.state.games);a[t]=null,e.setState({games:a}),t===e.props.match.params.ID&&e.props.history.replace("/")},e.mobileCheck=function(t){e.setState({mobile:t.matches})},e.viewGame=function(t){return e.props.history.push("/game/".concat(t))},e.authHandler=function(){var t=Object(h.a)(g.a.mark((function t(a){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.userExists(a.user)||e.addUser(a.user),e.setState({user:a.user,loggingIn:!1}),"/signup"===e.props.location.pathname&&e.props.history.push("/");case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.authenticate=function(t,a){e.setState({loading:!0}),(new oe.a.auth).signInWithEmailAndPassword(t,a).then((function(t){e.authHandler(t),console.log("firebase login",t),e.setState({loading:!1,signInError:null})})).catch((function(t){e.setState({signInError:t.message})}))},e.logout=Object(h.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,oe.a.auth().signOut();case 2:e.setState({user:{uid:""}});case 3:case"end":return t.stop()}}),t)}))),e.addUser=function(t){var a={email:t.email},n=Object(f.a)({},e.state.users);n[t.uid]=a,e.setState({users:n})},e.getUser=function(t){var a=null;return e.userExists(t)&&(a=e.state.users[t]),a},e.sanitizeDrinks=function(e){return e=e.replace(/([\d]+) drink(s)?/gi,"$1")},e.userExists=function(t){if(void 0===t)return!1;try{var a="string"===typeof t?t:t.uid;return void 0!==e.state.users[a]}catch(n){return console.error("Error checking for user",t),!1}},e.signup=function(t,a){oe.a.auth().createUserWithEmailAndPassword(t,a).then((function(t){e.authHandler(t)})).catch((function(t){e.setState({signupError:t.message})}))},e.onLoginClick=function(t){e.setState({loggingIn:!0})},e.userLoggedIn=function(){return""!==e.state.user.uid},e.renderAuthButton=function(){return""===e.state.user.uid?r.a.createElement("span",null,r.a.createElement("button",{className:"App__login-button link-button",onClick:e.onLoginClick},"Log In"),r.a.createElement(C.a,{to:"/signup",className:"App__sign-up-btn"},"Signup")):r.a.createElement("span",null,r.a.createElement("button",{onClick:e.logout,className:"App__logout-button link-button"},"Turn Down"))},e.showShortcuts=function(){e.shortCutsModal.current.show()},e}return Object(o.a)(a,[{key:"componentWillUpdate",value:function(){}},{key:"componentDidMount",value:function(){var e=this,t="localhost"===window.location.hostname?"dev":"live";this.fbRefU=de.syncState("drinking-games/".concat(t,"/users"),{context:this,state:"users"}),this.fbRefSessions=de.syncState("drinking-games/".concat(t,"/sessions"),{context:this,state:"sessions",then:function(t){var a=window.sessionStorage.getItem("currentSession");a&&!e.inASession()&&e.joinSession(a)}}),this.fbRef=de.syncState("drinking-games/".concat(t,"/games"),{context:this,state:"games",then:function(t){e.data=new y(e.state.games),0===Object.keys(e.state.games).length&&e.setState({games:v}),e.setState({loading:!1})}}),oe.a.auth().onAuthStateChanged((function(t){t&&e.authHandler({user:t})}))}},{key:"componentWillMount",value:function(){var e=window.matchMedia("(max-width: 1000px)");this.mobileCheck(e),e.addListener(this.mobileCheck)}},{key:"render",value:function(){if(this.data=new y(this.state.games),this.state.loggingIn&&"signup"!==this.mode)return r.a.createElement(se,{authenticate:this.authenticate,error:this.state.signInError});if(0===Object.keys(this.state.games).length)return r.a.createElement(E,{message:"Turning Up..."});if(this.state.loading)return r.a.createElement(E,{message:"Turning Up..."});var e=null;switch(this.props.mode){case"signup":e=r.a.createElement(ge,{signup:this.signup,error:this.state.signupError});break;case"join":var t=this.props.match.params.key;this.joinSession(t)&&this.props.history.push("/");break;default:e=r.a.createElement(re,{games:this.state.games,editGame:this.editGame,addGame:this.addGame,deleteGame:this.deleteGame,copyGame:this.copyGame,editRule:this.editRule,deleteRule:this.deleteRule,addRule:this.addRule,mode:this.props.mode,match:this.props.match,canEditGame:this.canEditGame,canEditRule:this.canEditRule,canDeleteGame:this.canDeleteGame,canDeleteRule:this.canDeleteRule,userLoggedIn:this.userLoggedIn,getUser:this.getUser,setSessionCombo:this.setSessionCombo,currentComboCount:this.getCurrentSessionComboCount(),createSession:this.createSession,leaveSession:this.leaveSession,joinSession:this.joinSession,currentSession:this.state.currentSession,renderAuthButton:this.renderAuthButton,user:this.state.user})}return r.a.createElement("div",{className:"App App--".concat(this.state.mobile?"mobile":"desktop")},e,r.a.createElement(ae,{ref:this.shortCutsModal}))}}]),a}(r.a.Component),fe=Object(te.a)(he),ve=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(u.a,null,r.a.createElement(m.a,null,r.a.createElement(d.a,{path:"/join/:key",render:function(e){return r.a.createElement(fe,Object.assign({},e,{mode:"join"}))}}),r.a.createElement(d.a,{path:"/game/:ID",render:function(e){return r.a.createElement(fe,Object.assign({},e,{mode:"game"}))}}),r.a.createElement(d.a,{exact:!0,path:"/signup",render:function(e){return r.a.createElement(fe,Object.assign({},e,{mode:"signup"}))}}),r.a.createElement(d.a,{exact:!0,path:"/",render:function(e){return r.a.createElement(fe,Object.assign({},e,{mode:"games"}))}}),r.a.createElement(d.a,{component:k})))}}]),a}(r.a.Component);a(54);Object(s.render)(r.a.createElement(ve,null),document.querySelector("#main"))}},[[32,1,2]]]);
//# sourceMappingURL=main.da7d1711.chunk.js.map