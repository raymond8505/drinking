(this.webpackJsonpcotd=this.webpackJsonpcotd||[]).push([[0],{30:function(e,t,a){e.exports=a(52)},51:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(26),i=a(4),o=a(5),l=a(6),u=a(7),c=a(56),m=a(58),d=a(55),p=a(17),h=a.n(p),g=a(23),f=a(8),v=function e(t){var a=this;Object(i.a)(this,e),this.data={},this.hasData=function(){return a.data&&Object.keys(a.data).length>0},this.forEach=function(e,t){if(void 0===t)throw new Error("DataHelper.forEach requires a data parameter");return Object.keys(t).map(e)},this.getGameByKey=function(e){return a.data[e]},this.getChildGames=function(e){var t={};return Object.keys(a.data).map((function(n){var r=a.getGameByKey(n);return r.parent_game===e&&(t[n]=r),null})),t},this.gameHasRules=function(e){return e.rules&&Object.keys(e.rules).length>0},this.getGameRules=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=a.getGameByKey(e),s={};if(a.gameHasRules(r)&&a.forEach((function(t){s[t]=Object.assign(r.rules[t],{gameKey:e})}),r.rules),t&&r.parent_game){var i=a.getGameByKey(r.parent_game);i&&(s=Object.assign(s,a.getGameRules(r.parent_game,t,n)))}return s},this.objectCollectionToArrayWithKey=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key",n=[];return a.forEach((function(a){var r=e[a];r[t]=a,n.push(r)}),e),n},this.arrayWithKeyToObjectCollection=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key",a={};return e.forEach((function(e){var n=e[t];e[t]=null,a[n]=e})),a},this.sortRules=function(e,t){var n=a.objectCollectionToArrayWithKey(e);return n.sort((function(e,n){var r="asc"==t.direction?1:-1,s="",i="";switch(t.field){case"rule":case"drinks":s=e[t.field].toLowerCase(),i=n[t.field].toLowerCase();break;case"game":s=a.getGameByKey(e.gameKey).title.toLowerCase(),i=a.getGameByKey(n.gameKey).title.toLowerCase();break;default:s=e[t.field],i=n[t.filed]}return(s=a.sanitizeForSorting(s))<=(i=a.sanitizeForSorting(i))?-1*r:r})),a.arrayWithKeyToObjectCollection(n)},this.sanitizeForSorting=function(e){return['"',"'","-","(",")"].forEach((function(t){var a=new RegExp("^[".concat(t,"]+")),n=new RegExp("[".concat(t,"]+$"));e=e.replace(a,"").replace(n,"")})),e},this.getNewRuleKey=function(e){return"".concat(e,"_rule").concat(Date.now())},this.getNewGameKey=function(){return"game".concat(Date.now())},this.sortGamesBy=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=arguments.length>2?arguments[2]:void 0;if(void 0==n)return{};var r=[],s={},i=0===t.toLowerCase().indexOf("asc")?1:-1;return a.forEach((function(t){var n=a.getGameByKey(t);if(n)try{r.push({key:t,[e]:n[e]})}catch(s){return void console.log(n,s)}}),n),r.sort((function(t,a){switch(typeof t[e]){case"string":return t[e]&&a[e]?t[e].toLowerCase()<a[e].toLowerCase()?-1*i:1*i:0}})),r.forEach((function(e){s[e.key]=a.getGameByKey(e.key)})),s},this.getParentGame=function(e){var t=null,n=a.getGameByKey(e);return n&&n.parent_game&&(t={game:a.data[n.parent_game],key:n.parent_game}),t},this.getAncestors=function(e){for(var t,n=[],r=(a.getGameByKey(e),e);t=a.getParentGame(r);)r=t.key,n.push(t);return n.reverse()},this.gameHasOtherUserGames=function(e,t){var n=a.getChildGames(e),r=!0;return a.forEach((function(e){a.getGameByKey(e).owner==t||(r=!1)}),n),r},this.gameHasOtherUserOwnedRules=function(e,t){var n=!1;return a.forEach((function(a){var r=e.rules[a];r&&Object.keys(r).length>0&&r.owner&&r.owner!==t&&(n=!0)}),e.rules),n},this.data=t},y=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e="".concat(this.props.tag);return r.a.createElement(e,{className:"Alert Alert--".concat(this.props.type)},this.props.children)}}]),a}(r.a.Component);y.defaultProps={tag:"span",type:"info"};var b=y,E=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={currentMode:"display"},e.setEditing=function(t){e.setState({editing:t})},e.handleClick=function(t){t.preventDefault(),e.setState({currentMode:"display"===e.state.currentMode?"confirm":"display"}),e.props.handler(t)},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("button",{className:"EditButton EditButton--".concat(this.state.currentMode),onClick:this.handleClick},r.a.createElement("span",{className:"sr-only"},"display"===this.state.currentMode?"Edit":"Confirm"),r.a.createElement("i",{className:"EditButton__icon",role:"presentation"}))}}]),a}(r.a.Component),k=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={currentMode:"display"},e.handleClick=function(t){t.preventDefault(),e.setState({currentMode:"display"===e.state.currentMode?"confirm":"display"}),e.props.handler(t)},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("button",{className:"DeleteButton DeleteButton--".concat(this.state.currentMode),onClick:this.handleClick},r.a.createElement("span",{className:"sr-only"},"display"===this.state.currentMode?"Edit":"Confirm"),r.a.createElement("i",{className:"DeleteButton__icon",role:"presentation"}))}}]),a}(r.a.Component),G=a(54),R=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).titleField=r.a.createRef(),e.state={editing:!1,game:{}},e.onAddEditClick=function(t){var a=!e.state.editing;a||(e.props.game.title=e.titleField.current.value,e.props.editGame(e.props.index,e.props.game)),e.setState({editing:a})},e.onDeleteClick=function(t){window.confirm('Are you sure you want to delete "'.concat(e.game.title,'"'))&&e.props.deleteGame(e.props.index)},e.onNameInputKeyPress=function(t){13===t.which&&e.onAddEditClick()},e.renderName=function(){var t=r.a.createElement("input",{onClick:e.viewGame,name:"GameListItem__title",ref:e.titleField,className:"GameListItem__title editable",onKeyPress:e.onNameInputKeyPress,defaultValue:e.game.title}),a=r.a.createElement(G.a,{to:"/game/".concat(e.props.index),className:"GameListItem__title"},e.game.title);return e.state.editing?t:a},e.handleDoubleClick=function(t){e.state.editing||e.setState({editing:!0})},e.onCopyClick=function(t){e.props.copyGame(e.props.index)},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.setState({game:this.props.game})}},{key:"componentDidUpdate",value:function(){this.titleField&&this.titleField.current&&this.titleField.current.focus()}},{key:"render",value:function(){return this.data=new v(this.props.games),this.game=this.data.getGameByKey(this.props.index),r.a.createElement("li",{className:"GameListItem",id:this.props.index,onDoubleClick:this.handleDoubleClick},r.a.createElement("header",{className:"GameListItem__header"},this.renderName(),r.a.createElement("span",{className:"GameListItem__controls-shell"},this.props.canEditGame(this.game)?r.a.createElement(E,{handler:this.onAddEditClick}):null,this.props.canDeleteGame(this.props.index)?r.a.createElement(k,{handler:this.onDeleteClick}):null,this.props.userLoggedIn()?r.a.createElement("button",{type:"button",className:"GameListItem__copy-btn",onClick:this.onCopyClick},r.a.createElement("span",{className:"sr-only"},"duplicate this game"),r.a.createElement("i",{className:"fa fa-copy"})):null)),this.props.showChildren?r.a.createElement(_,{game:this.game,games:this.props.games,parent:this.props.index,canEditGame:this.props.canEditGame,canEditRule:this.props.canEditRule,canDeleteGame:this.props.canDeleteGame,canDeleteRule:this.props.canEditRule,copyGame:this.props.copyGame}):null)}}]),a}(r.a.Component);R.defaultProps={showChildren:!1};var C=R,w=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).renderGameList=function(){if(e.data&&e.data.hasData()){e.data=new v(e.props.games);var t=void 0!==e.props.parent?e.data.getChildGames(e.props.parent):e.data.sortGamesBy("title","asc",e.props.games);return t=e.data.sortGamesBy("title","asc",t),e.data.forEach((function(a){return r.a.createElement(C,{deleteGame:e.props.deleteGame,editGame:e.props.editGame,copyGame:e.props.copyGame,key:a,index:a,games:t,game:e.data.getGameByKey(a),canEditGame:e.props.canEditGame,canEditRule:e.props.canEditRule,canDeleteGame:e.props.canDeleteGame,userLoggedIn:e.props.userLoggedIn,canDeleteRule:e.props.canEditRule})}),t)}return r.a.createElement(b,{type:"error",tag:"li"},"No Games")},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.data=new v(this.props.games)}},{key:"render",value:function(){return this.data=new v(this.props.games),r.a.createElement("ul",{className:"GameList"},this.renderGameList())}}]),a}(r.a.Component);w.defaultProps={parent:void 0};var _=w,O=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).innerSelect=r.a.createRef(),e.test=function(){return e.innerSelect},e.outPutOptions=function(){var t=[];return e.data=new v(e.props.games),e.data.forEach((function(a){var n=e.data.getGameByKey(a);t.push(r.a.createElement("option",{key:"game-select_"+a,value:a,selected:a===e.props.defaultValue?"selected":""},n.title))}),e.data.sortGamesBy("title","asc",e.props.games)),t},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("select",{className:"GameSelect",ref:this.innerSelect,onChange:this.props.onChange},this.outPutOptions())}}]),a}(r.a.Component);O.defaultProps={includeToplevel:!1,defaultValue:"game0",onChange:function(e){}};var S=O,D=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).titleField=r.a.createRef(),e.gameSelect=r.a.createRef(),e.resetForm=function(){e.clearForm(),e.titleField.current.focus()},e.clearForm=function(){e.titleField.current.value="",e.gameSelect.current.innerSelect.current.value=e.props.parent},e.onKeyUp=function(t){e.props.listenForShortcuts&&13==t.which&&(e.onAddGameClick(),t.preventDefault())},e.onAddGameClick=function(t){var a=e.titleField.current.value,n=e.gameSelect.current.innerSelect.current.value;""!==a&&n&&""!==n&&(e.props.addGame(a,n),e.resetForm())},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"AddGameForm"},r.a.createElement("label",null,"Parent Game"),r.a.createElement(S,{games:this.props.games,includeToplevel:!0,defaultValue:this.props.parent,ref:this.gameSelect}),r.a.createElement("input",{type:"text",placeholder:"Game Title",ref:this.titleField,onKeyUp:this.onKeyUp}),r.a.createElement("button",{type:"text",onClick:this.onAddGameClick},"Add Game"))}}]),a}(r.a.Component);D.defaultProps={parent:"game0",listenForShortcuts:!1};var K=D,F=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).data=null,e}return Object(o.a)(a,[{key:"render",value:function(){this.data=new v(this.props.games);var e=this.props.games;return r.a.createElement("div",{className:"Games"},r.a.createElement("h1",null,"Drinking Games"),r.a.createElement(_,{games:e,deleteGame:this.props.deleteGame,editGame:this.props.editGame,canEditGame:this.props.canEditGame,canEditRules:this.props.canEditRules,canDeleteGame:this.props.canDeleteGame,canDeleteRules:this.props.canEditRules,copyGame:this.props.copyGame,userLoggedIn:this.props.userLoggedIn}),this.props.userLoggedIn()?r.a.createElement("section",{className:"Games__add-a-game"},r.a.createElement("h2",null,"Add a Game"),r.a.createElement(K,{games:this.props.games,listenForShortcuts:!0,addGame:this.props.addGame})):null)}}]),a}(r.a.Component);F.defaultProps={parent:"game0"};var j=F,x=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"NotFound"},r.a.createElement("h1",null,"Page Not Found"))}}]),a}(r.a.Component),N=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={editing:!1,rule:null},e.ruleField=r.a.createRef(),e.drinksField=r.a.createRef(),e.handleRuleEdit=function(t){var a=e.state.editing;if(e.setState({editing:!a}),e.drinksField&&e.ruleField&&e.drinksField.current&&e.ruleField.current){var n=e.drinksField.current.value,r=e.ruleField.current.value;""===n&&(n=e.state.rule.drinks),""===r&&(r=e.state.rule.rule);var s=Object(f.a)({},e.state.rule);s.rule=r,s.drinks=n,e.props.editRule(e.props.rule.gameKey,e.props.ruleIndex,s),e.setState({rule:s})}},e.handleRuleDelete=function(t){window.confirm("Are you sure you want to Delete the rule ".concat(e.state.rule.rule," (").concat(e.state.rule.drinks,")?"))&&(e.props.deleteRule(e.props.rule.gameKey,e.props.ruleIndex),e.setState({editing:!1}))},e.renderRule=function(){var t=r.a.createElement("input",{className:"RuleRow__title-field editable",onKeyPress:function(t){13===t.which&&e.handleRuleEdit()},type:"text",ref:e.ruleField,defaultValue:e.state.rule.rule}),a=r.a.createElement("span",{className:"RuleRow__title-field"},e.state.rule.rule);return e.state.editing?t:a},e.renderOwner=function(t){var a=e.props.getUser(t);return r.a.createElement("span",{class:"RuleRow__owner"},a?a.email:"Unknown User")},e.renderDrinks=function(){var t=r.a.createElement("input",{className:"RuleRow__drinks-field editable",type:"text",disabled:!e.state.editing,ref:e.drinksField,defaultValue:e.props.rule.drinks,onKeyPress:function(t){13===t.which&&e.handleRuleEdit()}}),a=r.a.createElement("span",{className:"RuleRow__drinks-field"},e.props.rule.drinks);return e.state.editing?t:a},e.handleDoubleClick=function(t){e.state.editing||e.setState({editing:!0})},e}return Object(o.a)(a,[{key:"componentDidUpdate",value:function(){this.ruleField&&this.ruleField.current&&this.ruleField.current.focus()}},{key:"componentWillMount",value:function(){this.setState({rule:this.props.rule}),this.data=new v(this.props.games)}},{key:"render",value:function(){var e=this.data.getGameByKey(this.props.rule.gameKey);return r.a.createElement("tr",{className:"RuleRow",onDoubleClick:this.handleDoubleClick},r.a.createElement("td",{className:"RuleRow__rule-cell"},this.renderRule()),r.a.createElement("td",{className:"RuleRow__drinks-cell"},this.renderDrinks()),r.a.createElement("td",{className:"RuleRow__game-cell"},r.a.createElement(G.a,{to:"/game/".concat(this.props.rule.gameKey),className:"RuleRow__game-link"},e.title)),r.a.createElement("td",{className:"RuleRow__owner-cell"},this.renderOwner(this.props.rule.owner)),r.a.createElement("td",{className:"RuleRow__controls-cell"},this.props.canEditRule(this.props.rule)?r.a.createElement(E,{handler:this.handleRuleEdit}):null,this.props.canDeleteRule(this.props.rule)?r.a.createElement(k,{handler:this.handleRuleDelete}):null))}}]),a}(r.a.Component);N.defaultProps={};var V=N,L=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={rules:void 0,currentFilter:"",order:null},e.filterField=r.a.createRef(),e.ruleMatchesFilter=function(t){return""===e.state.currentFilter||(e.state.currentFilter.toLowerCase().indexOf(t.toLowerCase())>-1||t.toLowerCase().indexOf(e.state.currentFilter.toLowerCase())>-1)},e.renderRuleRows=function(){return r.a.createElement("tbody",null,e.data.forEach((function(t){var a=e.rules[t];if(e.ruleMatchesFilter(a.rule))return r.a.createElement(V,{games:e.props.games,key:t,rule:a,ruleIndex:t,gameIndex:e.props.index,deleteRule:e.deleteRule,editRule:e.props.editRule,canEditRule:e.props.canEditRule,canDeleteRule:e.props.canEditRule,getUser:e.props.getUser})}),e.rules))},e.onFilterKeyUp=function(t){var a=t.currentTarget.value;e.setState({currentFilter:a})},e.deleteRule=function(t,a){var n=Object(f.a)({},e.rules);n[a]&&(delete n[a],e.setState({rules:n}),e.props.deleteRule(t,a))},e.onHeaderCellClick=function(t){var a=t.target;if(a){var n=a.getAttribute("data-field"),r=e.state.order?Object(f.a)({},e.state.order):{field:"",direction:""};r.field===n?r.direction="asc"===r.direction?"desc":"asc":(r.direction="asc",r.field=n),e.setState({order:r})}},e.renderSortLabel=function(t){return e.state.order&&t===e.state.order.field?"asc"===e.state.order.direction?r.a.createElement("span",{className:"RulesList__sort-direction fa fa-chevron-up"}):r.a.createElement("span",{className:"RulesList__sort-direction fa fa-chevron-down"}):null},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keydown",(function(t){t.shiftKey&&(t.metaKey||t.ctrlKey)&&70===t.which&&e.filterField.current.focus()}))}},{key:"render",value:function(){return this.data=new v(this.props.games),this.rules=this.data.getGameRules(this.props.index,!0),this.state.order&&(this.rules=this.data.sortRules(this.rules,this.state.order)),r.a.createElement("div",{className:"RulesList"},r.a.createElement("header",{className:"RulesList__header"},r.a.createElement("input",{ref:this.filterField,type:"search",className:"RulesList__filter-field",placeholder:"Find A Rule",onKeyUp:this.onFilterKeyUp})),r.a.createElement("table",{cellPadding:"0",cellSpacing:"0"},r.a.createElement("thead",{className:"RulesList__header"},r.a.createElement("tr",null,r.a.createElement("th",{className:"RulesList__rule-cell","data-field":"rule",onClick:this.onHeaderCellClick},"Rule",this.renderSortLabel("rule")),r.a.createElement("th",{className:"RulesList__drinks-cell","data-field":"drinks",onClick:this.onHeaderCellClick},"Drinks",this.renderSortLabel("drinks")),r.a.createElement("th",{className:"RulesList__game-cell","data-field":"game",onClick:this.onHeaderCellClick},"Game",this.renderSortLabel("game")),r.a.createElement("th",{className:"RulesList__owner-cell","data-field":"owner"},"Owner"),r.a.createElement("th",{className:"RulesList__controls-cell"},"\xa0"))),this.renderRuleRows()))}}]),a}(r.a.Component);L.defaultProps={recursive:!1};var T=L,A=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).gameSelect=r.a.createRef(),e.ruleField=r.a.createRef(),e.drinksField=r.a.createRef(),e.onWindowKeyPress=function(t){174===t.which&&t.altKey&&(e.ruleField.current.focus(),t.preventDefault())},e.resetForm=function(){e.gameSelect.current.test().current.value=e.props.gameIndex,e.ruleField.current.focus()},e.clearForm=function(){e.ruleField.current.value=e.drinksField.current.value=""},e.handleAddClick=function(t){var a=e.gameSelect.current.innerSelect.current.value,n=e.ruleField.current.value,r=e.drinksField.current.value;if(""!==s&&""!==r&&a&&""!==a){var s={rule:n,drinks:r};e.props.addRule(a,s),e.clearForm(),e.resetForm()}else alert("Please choose a game, enter a rule and a drink penalty.")},e.onKeyUp=function(t){13==t.which&&(e.handleAddClick(),t.preventDefault())},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.data=new v(this.props.games),window.addEventListener("keypress",this.onWindowKeyPress)}},{key:"render",value:function(){this.data=new v(this.props.games);var e=this.data.sortGamesBy("title","asc",this.props.games);return r.a.createElement("div",{className:"AddRulesForm"},r.a.createElement(S,{games:e,name:"game",defaultValue:this.props.gameIndex,ref:this.gameSelect,className:"AddRulesForm__game-select"}),r.a.createElement("textarea",{placeholder:"Rule",name:"rule",ref:this.ruleField,className:"AddRulesForm__rule-field"}),r.a.createElement("input",{type:"text",name:"drinks",ref:this.drinksField,onKeyUp:this.onKeyUp,placeholder:"Drinks",className:"AddRulesForm__drinks-field"}),r.a.createElement("button",{type:"button",onClick:this.handleAddClick},"Add Rule"))}}]),a}(r.a.Component);A.defaultProps={};var I=A;var W=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={count:0,animating:!1,open:!0},e.maxCombo=10,e.animateSpeed=180,e.onGlobalKeyPress=function(t){switch(t.which){case 107:e.addDrink();break;case 109:e.removeDrink();break;case 106:e.clearDrinks()}},e.addDrink=function(){if(e.props.count<e.maxCombo){var t=e.props.count+1;e.props.setSessionCombo(t)}},e.removeDrink=function(){e.props.count>0&&e.props.setSessionCombo(e.props.count-1)},e.clearDrinks=function(){e.props.setSessionCombo(0)},e.handleRemoveDrinkClick=function(t){e.props.count>0&&(e.removeDrink(),e.animateCount())},e.handleClearDrinksClick=function(t){e.clearDrinks()},e.animateCount=function(){e.setState({animating:!0}),setTimeout((function(){e.setState({animating:!1})}),e.animateSpeed)},e.handleAddDrinkClick=function(t){e.props.count<e.maxCombo&&(e.addDrink(),e.animateCount())},e.calcShotHeight=function(){return 0===e.props.count?0:e.props.count/e.maxCombo*100+"%"},e.handleToggleClick=function(t){e.setState({open:!e.state.open})},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){window.addEventListener("keyup",this.onGlobalKeyPress)}},{key:"render",value:function(){return r.a.createElement("aside",{className:"ComboCounter".concat(this.state.animating?" ComboCounter--animating":" ComboCounter--animated").concat(this.props.count===this.maxCombo?" ComboCounter--full":"").concat(0===this.props.count?" ComboCounter--empty":"").concat(this.state.open?" ComboCounter--open":" ComboCounter--closed")},r.a.createElement("button",{className:"ComboCounter__toggle-btn ComboCounter__toggle-btn--open",onClick:this.handleToggleClick},r.a.createElement("i",{className:"fa fa-chevron-left"})),r.a.createElement("div",{className:"ComboCounter__count"},this.props.count),r.a.createElement("div",{class:"ComboCounter__glass-wrap"},r.a.createElement("div",{className:"ComboCounter__shot-glass"},r.a.createElement("div",{className:"ComboCounter__shot-volume",style:{height:this.calcShotHeight()}})),r.a.createElement("div",{className:"ComboCounter__button-shell"},r.a.createElement("button",{className:"ComboCounter__remove-drink-btn",onClick:this.handleRemoveDrinkClick},"-"),r.a.createElement("button",{className:"ComboCounter__clear-drinks-btn",onClick:this.handleClearDrinksClick},"\xd7"))),r.a.createElement("button",{className:"ComboCounter__add-drink-btn",onClick:this.handleAddDrinkClick},"+"),r.a.createElement("button",{className:"ComboCounter__toggle-btn ComboCounter__toggle-btn--close",onClick:this.handleToggleClick},r.a.createElement("i",{className:"fa fa-chevron-right"})))}}]),a}(r.a.Component);W.defaultTypes={};var H=W,q=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={game:void 0,editing:!1},e.titleInput=r.a.createRef(),e.editButton=r.a.createRef(),e.shell=r.a.createRef(),e.onParentChange=function(t){var a=t.currentTarget.value,n=e.props.index,r=Object(f.a)({},e.data.getGameByKey(n));r.parent_game=a,console.log(r),e.props.editGame(n,r)},e.handleTitleEditClick=function(t){if(e.state.editing){var a=e.data.getGameByKey(e.props.index);""===e.titleInput.current.value?e.titleInput.current.value=a.title:e.titleInput.current.value!==a.title&&(a.title=e.titleInput.current.value,e.props.editGame(e.props.index,a))}else e.titleInput.current.focus();e.setState({editing:!e.state.editing})},e.onDeleteClick=function(t){e.data=new v(e.props.games);var a=e.data.getGameByKey(e.props.index);window.confirm('Are you sure you want to delete "'.concat(a.title,'"?'))&&e.props.deleteGame(e.props.index)},e.renderBreadCrumbs=function(){var t=e.data.getAncestors(e.props.index),a=[];return t.forEach((function(e,n){a.push(r.a.createElement(G.a,{to:"/game/".concat(e.key)},e.game.title)),n<t.length-1&&a.push(r.a.createElement("span",{class:"Game__parent-delimiter"},">"))})),a},e}return Object(o.a)(a,[{key:"componentDidUpdate",value:function(){this.state.editing&&this.titleInput.current.focus(),this.shell.current.scrollTo(0,0)}},{key:"render",value:function(){var e=this;this.data=new v(this.props.games);var t,a=this.data.getGameByKey(this.props.index);a.parent_game&&this.data.getGameByKey(a.parent_game);return a?(t=a.title+" | Drinking Games",document.querySelector("head title").innerText=t,r.a.createElement("div",{className:"Game",ref:this.shell},r.a.createElement(H,{setSessionCombo:this.props.setSessionCombo,count:this.props.currentComboCount}),this.renderBreadCrumbs(),r.a.createElement("h1",{className:"Game__title"},r.a.createElement("input",{name:this.props.index+Date.now(),key:this.props.index+Date.now(),type:"text",defaultValue:a.title,ref:this.titleInput,disabled:!this.state.editing,className:"Game__title-value editable",onKeyPress:function(t){13===t.which&&e.handleTitleEditClick()}}),this.props.canEditGame(this.props.index)?r.a.createElement("div",{className:"Game__parent-change-select"},r.a.createElement("label",null,"Parent:"),"  ",r.a.createElement(S,{onChange:this.onParentChange,defaultValue:this.data.getGameByKey(this.props.index).parent_game,games:this.props.games}),r.a.createElement(E,{handler:this.handleTitleEditClick,ref:this.editButton}),this.props.canDeleteGame(this.props.index)?r.a.createElement(k,{handler:this.onDeleteClick}):null):null),r.a.createElement("section",{className:"Game__rules"},r.a.createElement("h2",null,"Rules"),r.a.createElement(T,{games:this.props.games,index:this.props.index,recursive:!0,deleteRule:this.props.deleteRule,editRule:this.props.editRule,canEditRule:this.props.canEditRule,canDeleteRule:this.props.canEditRule,getUser:this.props.getUser})),this.props.userLoggedIn()?r.a.createElement("section",{className:"Game__add-rules"},r.a.createElement("h3",null,"Add Rule"),r.a.createElement(I,{games:this.props.games,gameIndex:this.props.index,addRule:this.props.addRule})):null,r.a.createElement("section",{className:"Game__child-games"},r.a.createElement("h2",null,"Sub Games"),r.a.createElement(_,{parent:this.props.index,editGame:this.props.editGame,games:this.props.games,deleteGame:this.props.deleteGame,canEditGame:this.props.canEditGame,canEditRule:this.props.canEditRule,canDeleteGame:this.props.canDeleteGame,canDeleteRule:this.props.canEditRule,userLoggedIn:this.props.userLoggedIn}),r.a.createElement("h3",null,"Add A Sub Game"),this.props.userLoggedIn()?r.a.createElement(K,{games:this.props.games,parent:this.props.index,addGame:this.props.addGame}):null))):x}}]),a}(r.a.Component),U={game0:{rules:{game0_rule1585428503206:{drinks:"2 drinks",gameKey:"game0",owner:"WCRKE62ab8gw6FB2iCYkOX4XmIg2",rule:"The name of the episode or movie is said or written"},game0_rule1585443393434:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"obvious stock footage"},game0_rule1585443993724:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"ESL Characters speaking English for no reason"},game0_rule1585444223055:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"nut shot"},game0_rule1585445102020:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"obviously empty coffee cup"},game0_rule1585447770911:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"someone rips up a photo "},game0_rule1585507595857:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:'Incorrect portrayal of "hacking"'},game0_rule1585528860565:{drinks:"1",gameKey:"game0",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"romantic tension between non spouses (will they / wont they characters)"}},title:"General Rules"},game1:{parent_game:"game0",rules:{game1_rule1:{drinks:"1 drink",gameKey:"game1",rule:"Bone snap"},game1_rule1585442777686:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Explosion"},game1_rule1585442794346:{drinks:"2",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"cool explosion (ex: slow mo)"},game1_rule1585442823231:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"unrealistic survival / healing"},game1_rule1585442901374:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"glass breaks"},game1_rule1585442925083:{drinks:"3",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"decapitation"},game1_rule1585443336960:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"slow motion"},game1_rule1585444849287:{drinks:"3",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:'"turn in your badge and gun" / "youre suspended!" / etc'},game1_rule1585448652082:{drinks:"1",gameKey:"game1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"headshot"}},title:"Action"},game1585442982618:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game0",rules:{game1585442982618_rule1585442993103:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Any dino related pun"},game1585442982618_rule1585443044303:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Anytime you see a choker or midriff"},game1585442982618_rule1585443065678:{drinks:"drink til it stops",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Dino roar"},game1585442982618_rule1585443084585:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"bad cgi"},game1585442982618_rule1585443110038:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"T Rex does something with his hands"},game1585442982618_rule1585443158546:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Dinosaur is too big to fit in something"},game1585442982618_rule1585443171333:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"poor dino disguising / someone doesnt notice the dino is alive"},game1585442982618_rule1585448716738:{drinks:"1",gameKey:"game1585442982618",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"someone grabs someone else's dick"}},title:"Tammy and the T Rex"},game1585446169128:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1",rules:{game1585446169128_rule1585446187228:{drinks:"1",gameKey:"game1585446169128",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:'"enhance"'}},title:"Police / Crime"},game1585519764301:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1",rules:{game1585519764301_rule1585519780902:{drinks:"1",gameKey:"game1585519764301",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Cross Fade"},game1585519764301_rule1585519789583:{drinks:"1",gameKey:"game1585519764301",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Saxophone Soundtrack"}},title:"Man Hunt"},game1585541082218:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1585541104293",rules:{game1585541082218_rule1585541134205:{drinks:"1",gameKey:"game1585541082218",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Something is bejewelled"},game1585541082218_rule1585541642525:{drinks:"1",gameKey:"game1585541082218",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"a tiger hurts or scares someone"},game1585541082218_rule1585545303143:{drinks:"1",gameKey:"game1585541082218",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"tacky / trashy decorations"}},title:"Tiger King"},game1585541104293:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game0",rules:{game1585541104293_rule1585751022903:{drinks:"1 drink",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Someone Cries"}},title:"Reality TV"},game1585600289161:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1",title:"Jason Statham"},game1585600326133:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game1585600289161",rules:{game1585600326133_rule1585600342757:{drinks:"1",owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",rule:"Statham uses his boomerang"}},title:"In The Name of the king"},game1585662389801:{owner:"",parent_game:"game1585541104293",title:"90 Day Fiance"},game1585662406239:{owner:"",parent_game:"game1585541104293",rules:{game1585662406239_rule1585662454054:{drinks:"everyone but the closest guess drinks. Price is right rules",gameKey:"game1585662406239",owner:"",rule:"Everyone guesses the budget of each bride before they say it"}},title:"Say Yes To The Dress"},game1585872782855:{owner:"uGqTXpxQHzg4K7DRhObVWvValvF3",parent_game:"game0",title:"test to delete"},game2:{parent_game:"game1",rules:{game2_rule1:{drinks:"1 drink",gameKey:"game2",rule:"Splits"}},title:"Jean Claude Van Damme"},game3:{parent_game:"game0",rules:{game3_rule1:{drinks:"1 sip",gameKey:"game3",owner:"WCRKE62ab8gw6FB2iCYkOX4XmIg2",rule:"Jump Scare"},game3_rule1585427944776:{drinks:"1 drink",gameKey:"game3",owner:"WCRKE62ab8gw6FB2iCYkOX4XmIg2",rule:"rule added by raymond@raymond"}},title:"Horror Movies"},game4:{parent_game:"game0",title:"Cartoons"},game5:{parent_game:"game4",rules:{game5_rule1:{drinks:"drink til it stops",gameKey:"game5",rule:"CGI Webslinging"}},title:"Adventures of Spiderman"}},B=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"Loader"},r.a.createElement("div",{className:"lds-dual-ring"}),""!==this.props.message?r.a.createElement("h4",{className:"Loader__message"},this.props.message):null)}}]),a}(r.a.Component);B.defaultProps={message:""};var z=B,X=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("main",{className:"Desktop"},r.a.createElement(j,{games:this.props.games,editGame:this.props.editGame,addGame:this.props.addGame,deleteGame:this.props.deleteGame,canEditGame:this.props.canEditGame,canEditRule:this.props.canEditRule,canDeleteGame:this.props.canDeleteGame,canDeleteRule:this.props.canEditRule,copyGame:this.props.copyGame,userLoggedIn:this.props.userLoggedIn,getUser:this.props.getUser}),"game"===this.props.mode?r.a.createElement(q,{index:this.props.match.params.ID,games:this.props.games,editRule:this.props.editRule,deleteRule:this.props.deleteRule,deleteGame:this.props.deleteGame,addRule:this.props.addRule,editGame:this.props.editGame,addGame:this.props.addGame,canEditGame:this.props.canEditGame,canEditRule:this.props.canEditRule,canDeleteGame:this.props.canDeleteGame,canDeleteRule:this.props.canEditRule,copyGame:this.props.copyGame,userLoggedIn:this.props.userLoggedIn,getUser:this.props.getUser,setSessionCombo:this.props.setSessionCombo,currentComboCount:this.props.currentComboCount}):r.a.createElement(b,{tag:"div",type:"info"},"Choose a game from the left hand menu"))}}]),a}(r.a.Component);X.defaultProps={};var P=X,Q=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).userField=r.a.createRef(),e.passwordField=r.a.createRef(),e.authenticate=function(t){console.log("loader auth");var a=e.userField.current.value,n=e.passwordField.current.value;e.props.authenticate(a,n)},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"Login"},r.a.createElement("form",{className:"Login__form"},r.a.createElement("h2",null,"Login"),r.a.createElement("p",null,"Sign in to start drinking"),this.props.error?r.a.createElement(b,{type:"error"},this.props.error):null,r.a.createElement("input",{type:"text",required:!0,ref:this.userField,placeholder:"Email"}),r.a.createElement("input",{type:"password",required:!0,ref:this.passwordField,placeholder:"Password"}),r.a.createElement("button",{type:"button",className:"Login__login",onClick:this.authenticate},"Turn Down For What"),r.a.createElement(G.a,{className:"Login__signup ",to:"/signup"},"Get Started Turnin' Up")))}}]),a}(r.a.Component),M=a(15),J=a.n(M),Y=a(27),$=a.n(Y),Z=J.a.initializeApp({apiKey:"AIzaSyBqPifaPtgVVbc222q6U09NBRuHTn9ECr0",authDomain:"raymond-catch-of-the-day.firebaseapp.com",databaseURL:"https://raymond-catch-of-the-day.firebaseio.com",projectId:"raymond-catch-of-the-day",storageBucket:"raymond-catch-of-the-day.appspot.com",messagingSenderId:"425132188904",appId:"1:425132188904:web:04405d03ba6769cc5f555d",measurementId:"G-SJZ98PJSWE"}),ee=$.a.createClass(Z.database()),te=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).userField=r.a.createRef(),e.passwordField=r.a.createRef(),e.passwordField2=r.a.createRef(),e.state={error:null},e.signup=function(t){var a=e.userField.current.value,n=e.passwordField.current.value;n!==e.passwordField2.current.value?e.setState({error:"Passwords don't match"}):e.props.signup(a,n)},e}return Object(o.a)(a,[{key:"componentWillMount",value:function(){this.setState({error:this.props.error})}},{key:"render",value:function(){var e=this.props.error||this.state.error;return r.a.createElement("div",{className:"Signup"},r.a.createElement("form",{className:"Signup__form"},r.a.createElement("h2",null,"Signup"),r.a.createElement("p",null,"Sign in to start drinking"),e?r.a.createElement(b,{type:"error"},e):null,r.a.createElement("input",{type:"text",required:!0,ref:this.userField,placeholder:"Email"}),r.a.createElement("input",{type:"password",required:!0,ref:this.passwordField,placeholder:"Password"}),r.a.createElement("input",{type:"password",required:!0,ref:this.passwordField2,placeholder:"Confirm Password"}),r.a.createElement("button",{type:"button",className:"Signup__Signup",onClick:this.signup},"Turn Down For What")))}}]),a}(r.a.Component);te.defaultProps={error:null};var ae=te,ne=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={currentSession:e.props.currentSession},e.keyField=r.a.createRef(),e.handleCreateSession=function(t){e.props.createSession()},e.leaveSession=function(){e.setState({currentSession:void 0}),e.props.leaveSession()},e.handleJoinSession=function(t){var a=e.keyField.current.value;e.props.joinSession(a)},e.renderSessionButtons=function(){return void 0===e.state.currentSession?r.a.createElement("div",null,r.a.createElement("button",{className:"SessionManager__create-session",onClick:e.handleCreateSession},"Create Session"),r.a.createElement("input",{type:"text",className:"SessionManager__key-field",ref:e.keyField,placeholder:"Session Code"}),r.a.createElement("button",{className:"SessionManager__join-session",onClick:e.handleJoinSession},"Join Session")):r.a.createElement("div",{className:"SessionManager__current-session"},r.a.createElement("span",{className:"SeassionManager__session-key"},e.state.currentSession),r.a.createElement("button",{className:"SessionManager__leave-session-btn",onClick:e.leaveSession},"Leave Session"))},e}return Object(o.a)(a,[{key:"render",value:function(){return this.state.currentSession=this.props.currentSession,r.a.createElement("div",{className:"SessionManager"},this.renderSessionButtons())}}]),a}(r.a.Component);ne.defaultTypes={};var re=ne,se=a(57),ie=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={games:{},mobile:!1,user:{uid:""},users:{},loading:!0,signupError:null,loginError:null,loggingIn:!1,currentSession:void 0,sessions:{}},e.RAYMOND_UID="uGqTXpxQHzg4K7DRhObVWvValvF3",e.sessionKeyLength=4,e.editGame=function(t,a){var n=Object(f.a)({},e.state.games);n[t]=a,e.setState({games:n})},e.getCurrentSessionComboCount=function(){return e.inASession()?e.state.sessions[e.state.currentSession].currentComboCount:0},e.setSession=function(t){var a={created:(new Date).getTime(),currentComboCount:0},n=Object(f.a)({},e.state.sessions);n[t]=a,e.setState({currentSession:t}),console.log("setting session local only"),e.setState({sessions:n})},e.inASession=function(){return void 0!==e.state.currentSession},e.setSessionCombo=function(t){if(e.inASession()){var a=Object(f.a)({},e.state.sessions);a[e.state.currentSession].currentComboCount=t,e.setState({sessions:a})}},e.joinSession=function(t){return t=t.toUpperCase(),e.sessionKeyExists(t)?(e.setState({currentSession:t}),!0):(console.log(t,e.state.sessions),alert('No session with the code "'.concat(t,'" currently exists.')),!1)},e.leaveSession=function(){e.setState({currentSession:void 0})},e.sessionKeyExists=function(t){return void 0!==e.state.sessions[t]},e.generateSessionKey=function(){for(var t,a="",n=0;n<e.sessionKeyLength;n++)t=Math.round(25*Math.random())+65,a+=String.fromCharCode(t);return a.toUpperCase()},e.generateUniqueSessionKey=function(){var t=e.generateSessionKey();do{t=e.generateSessionKey()}while(void 0!==e.state.sessions[t]);return t},e.createSession=function(){var t=e.generateUniqueSessionKey();return e.setSession(t),t},e.canEditRule=function(t){return e.userLoggedIn()},e.canEditGame=function(t){var a="string"===typeof t?e.data.getGameByKey(t):t;return e.state.user.uid===e.RAYMOND_UID||a.owner&&a.owner===e.state.user.uid},e.canDeleteRule=function(t){return e.state.user.uid===e.RAYMOND_UID||t.owner===e.state.user.uid},e.canDeleteGame=function(t){var a=e.data.getGameByKey(t);return e.state.user.uid===e.RAYMOND_UID||!(!a.owner||a.owner!==e.state.user.uid)&&e.data.gameHasOtherUserGames(t,e.state.user.uid)},e.editRule=function(t,a,n){var r=Object(f.a)({},e.state.games),s=r[t];n.drinks=e.sanitizeDrinks(n.drinks),s&&s.rules&&s.rules[a]&&(r[t].rules[a]=n,e.setState({games:r}))},e.deleteRule=function(t,a){var n=Object(f.a)({},e.state.games);n&&n[t]&&n[t].rules[a]&&(n[t].rules[a]=null,e.setState({games:n}))},e.addRule=function(t,a){a.owner=e.state.user.uid;var n=e.data.getNewRuleKey(t),r=Object(f.a)({},e.state.games);r[t].rules||(r[t].rules={}),r[t].rules[n]=a,e.setState({games:r})},e.addGame=function(t,a){var n={title:t,rules:{}};n.owner=e.state.user.uid,""!==a&&(n.parent_game=a);var r=Object(f.a)({},e.state.games),s=e.data.getNewGameKey();r[s]=n,e.setState({games:r}),e.viewGame(s)},e.copyRules=function(t,a,n){t=Object(f.a)({},t);var r={};return e.data.forEach((function(s){var i=s.replace(a,n);r[i]=Object(f.a)({},t[s]),r[i].gameKey=n,r[i].owner=e.state.user.uid}),t),r},e.copyGame=function(t){e.data=new v(e.state.games);var a=Object(f.a)({},e.state.games),n=Object(f.a)({},e.data.getGameByKey(t)),r=e.data.getNewGameKey();n.title+=" Copy",n.owner=e.state.user.uid,a[r]=n,a[r].rules=e.copyRules(n.rules,t,r),e.setState({games:a}),e.viewGame(r)},e.deleteGame=function(t){var a=Object(f.a)({},e.state.games);a[t]=null,e.setState({games:a}),t===e.props.match.params.ID&&e.props.history.replace("/")},e.mobileCheck=function(t){e.setState({mobile:t.matches})},e.viewGame=function(t){return e.props.history.push("/game/".concat(t))},e.authHandler=function(){var t=Object(g.a)(h.a.mark((function t(a){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.userExists(a.user)||e.addUser(a.user),e.setState({user:a.user,loggingIn:!1}),"/signup"==e.props.location.pathname&&e.props.history.push("/");case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.authenticate=function(t,a){e.setState({loading:!0}),(new J.a.auth).signInWithEmailAndPassword(t,a).then((function(t){e.authHandler(t),console.log("firebase login",t),e.setState({loading:!1,signInError:null})})).catch((function(t){e.setState({signInError:t.message})}))},e.logout=Object(g.a)(h.a.mark((function t(){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J.a.auth().signOut();case 2:e.setState({user:{uid:""}});case 3:case"end":return t.stop()}}),t)}))),e.addUser=function(t){var a={email:t.email},n=Object(f.a)({},e.state.users);n[t.uid]=a,e.setState({users:n})},e.getUser=function(t){var a=null;return e.userExists(t)&&(a=e.state.users[t]),a},e.sanitizeDrinks=function(e){return e=e.replace(/([\d]+) drink(s)?/gi,"$1")},e.userExists=function(t){if(void 0===t)return!1;try{var a="string"===typeof t?t:t.uid;return void 0!==e.state.users[a]}catch(n){return console.error("Error checking for user",t),!1}},e.signup=function(t,a){J.a.auth().createUserWithEmailAndPassword(t,a).then((function(t){e.authHandler(t)})).catch((function(t){e.setState({signupError:t.message})}))},e.onLoginClick=function(t){e.setState({loggingIn:!0})},e.userLoggedIn=function(){return""!==e.state.user.uid},e.renderAuthButton=function(){return""===e.state.user.uid?r.a.createElement("span",null,r.a.createElement("button",{className:"App__login-button link-button",onClick:e.onLoginClick},"Log In"),r.a.createElement(G.a,{to:"/signup",className:"App__sign-up-btn"},"Signup")):r.a.createElement("span",null,r.a.createElement("button",{onClick:e.logout,className:"App__logout-button link-button"},"Turn Down"))},e}return Object(o.a)(a,[{key:"componentWillUpdate",value:function(){}},{key:"componentDidMount",value:function(){var e=this,t="localhost"===window.location.hostname?"dev":"live";this.fbRefU=ee.syncState("drinking-games/".concat(t,"/users"),{context:this,state:"users"}),this.fbRefSessions=ee.syncState("drinking-games/".concat(t,"/sessions"),{context:this,state:"sessions"}),this.fbRef=ee.syncState("drinking-games/".concat(t,"/games"),{context:this,state:"games",then:function(t){e.data=new v(e.state.games),0===Object.keys(e.state.games).length&&e.setState({games:U}),e.setState({loading:!1})}}),J.a.auth().onAuthStateChanged((function(t){t&&e.authHandler({user:t})}))}},{key:"componentWillMount",value:function(){var e=window.matchMedia("(max-width: 1000px)");this.mobileCheck(e),e.addListener(this.mobileCheck)}},{key:"render",value:function(){if(this.data=new v(this.state.games),this.state.loggingIn&&"signup"!==this.mode)return r.a.createElement(Q,{authenticate:this.authenticate,error:this.state.signInError});if(0===Object.keys(this.state.games).length)return r.a.createElement(z,{message:"Turning Up..."});if(this.state.loading)return r.a.createElement(z,{message:"Turning Up..."});var e=null;if(this.state.mobile)switch(this.props.mode){case"games":e=r.a.createElement(j,{games:this.state.games,editGame:this.editGame,addGame:this.addGame,deleteGame:this.deleteGame,copyGame:this.copyGame,editRule:this.editRule,deleteRule:this.deleteRule,addRule:this.addRule,mode:this.props.mode,match:this.props.match,canEditGame:this.canEditGame,canEditRule:this.canEditRule,canDeleteGame:this.canDeleteGame,canDeleteRule:this.canDeleteRule,userLoggedIn:this.userLoggedIn,getUser:this.getUser});break;case"game":e=r.a.createElement(q,{index:this.props.match.params.ID,games:this.state.games,editGame:this.editGame,addGame:this.addGame,deleteGame:this.deleteGame,copyGame:this.copyGame,editRule:this.editRule,deleteRule:this.deleteRule,addRule:this.addRule,mode:this.props.mode,match:this.props.match,canEditGame:this.canEditGame,canEditRule:this.canEditRule,canDeleteGame:this.canDeleteGame,canDeleteRule:this.canDeleteRule,userLoggedIn:this.userLoggedIn,getUser:this.getUser,setSessionCombo:this.setSessionCombo});break;case"signup":e=r.a.createElement(ae,{error:this.state.signupError,signup:this.signup});break;default:e=r.a.createElement(x,null)}else switch(this.props.mode){case"signup":e=r.a.createElement(ae,{signup:this.signup,error:this.state.signupError});break;default:e=r.a.createElement(P,{games:this.state.games,editGame:this.editGame,addGame:this.addGame,deleteGame:this.deleteGame,copyGame:this.copyGame,editRule:this.editRule,deleteRule:this.deleteRule,addRule:this.addRule,mode:this.props.mode,match:this.props.match,canEditGame:this.canEditGame,canEditRule:this.canEditRule,canDeleteGame:this.canDeleteGame,canDeleteRule:this.canDeleteRule,userLoggedIn:this.userLoggedIn,getUser:this.getUser,setSessionCombo:this.setSessionCombo,currentComboCount:this.getCurrentSessionComboCount()})}return r.a.createElement("div",{className:"App App--".concat(this.state.mobile?"mobile":"desktop")},r.a.createElement("header",{className:"App__header"},r.a.createElement("span",null,r.a.createElement(G.a,{to:"/",className:"App__home-link"},"Home"),this.renderAuthButton()),r.a.createElement(re,{createSession:this.createSession,leaveSession:this.leaveSession,joinSession:this.joinSession,currentSession:this.state.currentSession}),r.a.createElement("span",{className:"App__current-user"},this.state.user.email)),e)}}]),a}(r.a.Component),oe=Object(se.a)(ie),le=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement(c.a,null,r.a.createElement(m.a,null,r.a.createElement(d.a,{path:"/game/:ID",render:function(e){return r.a.createElement(oe,Object.assign({},e,{mode:"game"}))}}),r.a.createElement(d.a,{exact:!0,path:"/signup",render:function(e){return r.a.createElement(oe,Object.assign({},e,{mode:"signup"}))}}),r.a.createElement(d.a,{exact:!0,path:"/",render:function(e){return r.a.createElement(oe,Object.assign({},e,{mode:"games"}))}}),r.a.createElement(d.a,{component:x})))}}]),a}(r.a.Component);a(51);Object(s.render)(r.a.createElement(le,null),document.querySelector("#main"))}},[[30,1,2]]]);
//# sourceMappingURL=main.7b12efe0.chunk.js.map